Fred Buffington                Input for PBCC/QB              oasys@sbcglobal.net            06-14-02 (  :  )       PBCC,QB,PB             107  2790     SmpInput.bas----------------------------------------------------------ã'Fred Buffington - http://thunder.prohosting.com/~oasysã'Here is a simple Text input routine that can be used in ã'PBcc or QB and probably PBdos. ã ã'It includes a PBmain for testing purposes and to show  ã'sample calling sequence. ã ã $COMPILE EXE ã ã DECLARE FUNCTION Linput(xpos%,ypos%,L%,df$) AS STRING ã'------------------------------------------------ ã'Linput input routine print brackets around input ã'L% is length allow for the input routine ã'xpos,ypos initial position on screen ã'df$ is the default value ã'------------------------------------------------ ã FUNCTION PBMAIN() ã   CONSOLE SCREEN 26,80 ã ã   dflt$="TEST" ã   COLOR 15,1 ã   CLS ã   xvar$=linput(5,10,5,dflt$) ã ã   LOCATE 12,5:PRINT xvar$;"<here" 'test to show result ã   WHILE INKEY$="":WEND ã END FUNCTION ã ã FUNCTION Linput(x%,y%,L%,df$) AS STRING ã   LOCAL del$,lft$,rit$,zend$,hom$ ã ã   del$=CHR$(0)+CHR$(83)  'delete key ã   Lft$=CHR$(0)+CHR$(75)  'left arrow ã   rit$=CHR$(0)+CHR$(77)  'right arrow ã   zend$=CHR$(0)+CHR$(79) 'end key ã   hom$=CHR$(0)+CHR$(71)  'home key ã   position%=0 ã'   LOCATE y%,x%-1:PRINT "[";SPACE$(L%);"]"; ã'  above can be used to put brackets around the input ã   var$=df$ ã   LOCATE y%,x%:PRINT var$; ã   LOCATE y%,x% ã   DO ã ã       xinp$ = INKEY$ ã ã'checkmouse here ã ã       IF xinp$=zend$ THEN position%=l%-1 ã ã       IF xinp$=Hom$ THEN position%=0 ã ã       IF xinp$=lft$ THEN xinp$=CHR$(8) 'making 8 nondestructive ã ã       IF xinp$>CHR$(30) THEN ã              IF position%+1>LEN(var$) THEN ã ã                  var$=var$+xinp$:position%=position%+1 ã              ELSE ã                  MID$(var$,position%+1,1)=xinp$:position%=position%+1 ã ã              END IF ã ã        END IF ã ã        IF xinp$=CHR$(8) THEN ã ã'if you want descructive backspace then set xinp$ = del$ and rem position%=position%-1 ã ã             position%=position%-1 ã ã             IF position%<0 THEN position%=0 ã ã        END IF ã ã        IF xinp$ = del$ THEN ã ã            IF position%>0 THEN ã ã               var$=MID$(var$,1,position%)+MID$(var$,position%+2) ã ã            ELSE ã ã                 IF LEN(var$)>1 THEN ã ã                    var$=MID$(var$,2):position%=0 ã ã                 ELSE ã  ã                    var$="":position%=0 ã ã                 END IF ã ã            END IF ã ã        END IF ã ã        IF xinp$=rit$ THEN position%=position%+1 ã ã        IF position%>=L% THEN position%=L%-1 ã ã        IF xinp$<>"" THEN LOCATE y%,x%:PRINT SPACE$(L%);:LOCATE y%,x%:PRINT var$;:LOCATE y%,x%+position%:CURSOR ON ã ã   LOOP UNTIL xinp$=CHR$(13) OR xinp$=CHR$(27) ã   linput=var$ ã END FUNCTION ã