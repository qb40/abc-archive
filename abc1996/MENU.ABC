Alexander Podkolzin            WINDOWING AND MENUING SYSTEM   app@sbank.e-burg.su            11-10-95 (07:49)       PB                     160  6127     APPMENU.BAS '„' Simple windowing and menuing system, PowerBASIC.„' Author: Alexander Podkolzin  <APP@nw.sbank.e-burg.su>„' Public domain.„' You can modify the system easily, according to your„' preferences. Use it, as you want.„' I wrote these functions some years ago in TurboBASIC„' (Now i'm working with PB3.0). About 2 months ago I've„' slightly modified them and posted that demo to c.l.b.m.„' Source code was formatted by my program PBB.„'„'---------------------------------Demo here:-------------------------------„  DECLARE FUNCTION MenuItem(xb%,yb%,xe%,ye%,t%,b%,tn%,bn%,beg%) AS INTEGER„  DECLARE SUB PutAttribute(x%,y%,t%,b%)„  DECLARE SUB Win(t%,xb%,yb%,xe%,ye%,ct%,cb%)„'--------------------------------------------------------------------------„  DEFINT a-z„  COLOR 12,1„  CLS„  LOCATE 7,24„  PRINT "Simple windowing and menuing system"„  LOCATE 9,16„  PRINT "Author: Alexander Podkolzin <APP@nw.sbank.e-burg.su>"„  Win 1,33,11,47,15,0,3                 ' Look at function header below...„  COLOR 0,3„  LOCATE 12,35 : PRINT "First  item"„  LOCATE 13,35 : PRINT "Second item"„  LOCATE 14,35 : PRINT "Third  item"„  i = MenuItem(34,12,46,14,0,3,14,0,1)  ' Look at function header...„  COLOR 7,1„  LOCATE 18,32„  PRINT "Your choice is "; i„  BEEP„  END„'--------------------------------------------------------------------------„' "MenuItem" returns an integer value, corresponding to line of your choice,„'            or -1, if ESC is pressed.„' Parameters:„' xb%,yb%,xe%,ye%  - the window coordinates, you choose items from;„' NOTE: Coordinates order is in C-manner!„'             t%   - text color,„'             b%   - background color of the window;„'             tn%  - text color,„'             bn%  - background color of cursor bar;„'             beg% - initial position of cursor.„'„'--------------------------------------------------------------------------„  FUNCTION MenuItem(xb%,yb%,xe%,ye%,t%,b%,tn%,bn%,beg%)„     LOCAL item%,s$,i%„     item%=yb%+beg%-1                   ' Initial settings„     FOR i%=xb% TO xe%„        CALL PutAttribute(i%,item%,tn%,bn%)„     NEXT i%„     DO„        s$=""„        WHILE s$ = ""„           s$ = INKEY$„        WEND„        IF LEN(s$) = 2 THEN„           IF MID$(s$,2,1)="H" THEN                  ' "Up" code„              FOR i%=xb% TO xe%„                 CALL PutAttribute(i%,item%,t%,b%)   ' Restore initial„              NEXT i%                                ' colors„              item%=item%-1„              IF item%<yb% THEN„                 item%=ye%„              END IF„              FOR i%=xb% TO xe%„„                 CALL PutAttribute(i%,item%,tn%,bn%) ' Set new colors for„              NEXT i%                                ' cursor bar„           END IF„           IF MID$(s$,2,1)="P" THEN                  ' "Down" code„              FOR i%=xb% TO xe%„                 CALL PutAttribute(i%,item%,t%,b%)„              NEXT i%„              item%=item%+1„              IF item%>ye% THEN„                 item%=yb%„              END IF„              FOR i%=xb% TO xe%„                 CALL PutAttribute(i%,item%,tn%,bn%)„              NEXT i%„           END IF„        END IF„        i% = ASC(s$)„        IF i%=27 THEN                   ' "Esc" code„           MenuItem=-1„           GOSUB RestoreColor           ' Before EXIT we have„           EXIT FUNCTION                ' to restore colors„        END IF„        IF i%=13 THEN                   ' "Enter" code„           MenuItem=item%-yb%+1„           GOSUB RestoreColor„           EXIT FUNCTION„        END IF„     LOOP„„RestoreColor:„     FOR i%=xb% TO xe%„        CALL PutAttribute(i%,item%,t%,b%)„     NEXT i%„     RETURN„  END FUNCTION„'--------------------------------------------------------------------------„  SUB PutAttribute(x%,y%,t%,b%)         ' Puts attribute byte to video memory„     LOCAL c%                           ' directly to Colomn, Row position„     c% = b%*16+t%                      '„     DEF SEG = &hb800                   ' NOTE: This is system depending !„     POKE 160*(y%-1)+x%+x%-1,c%„     DEF SEG„  END SUB„'--------------------------------------------------------------------------„' Sub Win(t%,xb%,yb%,xe%,ye%,ct%,cb%)„' Parameters:„' t%               - the window type,„' xb%,yb%,xe%,ye%  - the window coordinates,„' NOTE: Coordinates order is in C-manner!„'             ct%  - text color,„'             cb%  - background color of the window;„'„'--------------------------------------------------------------------------„  SUB Win(t%,xb%,yb%,xe%,ye%,ct%,cb%)„'„     OldColor% = pbvScrnTxtAttr         ' Internal PB variable„'„     SELECT CASE t%                     ' Window types„'                                       ' (you can make as much types,„'                                       '  as you want):„        CASE 1„           a%=218:b%=196:c%=191         '⁄ƒƒƒƒƒƒƒø„           h%=179:      :d%=179         '≥   1   ≥„           g%=192:f%=196:e%=217         '¿ƒƒƒƒƒƒƒŸ„        CASE 2„           a%=201:b%=205:c%=187         '…ÕÕÕÕÕÕÕª„           h%=186:      :d%=186         '∫   2   ∫„           g%=200:f%=205:e%=188         '»ÕÕÕÕÕÕÕº„        CASE ELSE„           a%=032:b%= a%:c%= a%         '„           h%= a%: :d%= a%              ' Blanks only„           g%= a%:f%= a%:e%= a%         '„     END SELECT„     COLOR ct%,cb%„     LOCATE yb%,xb%   : PRINT CHR$(a%)+REPEAT$(xe%-xb%-1,CHR$(b%))+CHR$(c%)„     FOR i%=yb%+1 TO ye%-1„        LOCATE i%,xb% : PRINT CHR$(h%)+     SPACE$(xe%-xb%-1)     +CHR$(d%)„     NEXT„     LOCATE ye%,xb%   : PRINT CHR$(g%)+REPEAT$(xe%-xb%-1,CHR$(f%))+CHR$(e%)„     FOR i%=yb%+1 TO ye%+1„        PutAttribute xe%+1,i%,8,0       ' Maiking„     NEXT                               ' shadows„     FOR i%=xb%+1 TO xe%+1              '„        PutAttribute i%,ye%+1,8,0       '„     NEXT„     ct%=OldColor% AND 15               ' restore colors„     cb%=OldColor%\16„     COLOR ct%,cb%„  END SUB„'--------------------------------------------------------------------------„„Kurt Kuzba                     SCROLL BOX                     mhscards@aol.com               12-03-95 (17:46)       QB, QBasic, PDS        76   2948     SCROLBOX.BAS   'Try this out. Once I overcame my reluctance to figure out the„'scrollbox dilemna, I was able to create this function. I made it a„'FUNCTION, as opposed to a SUB, because it is also useful for menus,„'and you can always just disregard the return value. And speaking of„'disregard, thank you, and many others, for not adding to the pointless„'puffery over who is wasting more bandwidth by pointing out who is„'wasting more bandwidth by pointing out who is wasting, etc., etc.,„'etc..„'_|_|_|   SCROLBOX.BAS„'_|_|_|   This program demonstrates the use of a configurable scroll„'_|_|_|   box with hi-lite marker and line number display.„'_|_|_|   It will read and display itself when it is run.„'_|_|_|   Released to the   PUBLIC DOMAIN   by Kurt Kuzba.„DECLARE FUNCTION ScrollBox% (lim%, high%, wide%, LIN%, COL%)„'$DYNAMIC$„TYPE textline„   l AS STRING * 80„END TYPE„DIM SHARED txt(800) AS textline„OPEN "scroll.bas" FOR INPUT AS #1„t% = 0„WHILE ((t% < 800) AND (NOT EOF(1)))„   LINE INPUT #1, txt(t%).l„   t% = t% + 1„WEND„CLOSE 1„selected% = ScrollBox%(t%, 22, 76, 1, 1)„COLOR 2, 0: CLS : PRINT "You hit ENTER on array item"; selected%„END„'_|_|_|   end   SCROLBOX.BAS„„FUNCTION ScrollBox% (lim%, high%, wide%, LIN%, COL%)„   COLOR 7, 0: CLS : sel% = 0: top% = 0: ex% = lim%„   COLOR 9, 1: LOCATE 1, 1, 0: s$ = STRING$(wide%, " ")„   FOR t% = 0 TO high% + 1„      LOCATE LIN% + t%, COL%„      PRINT STRING$(wide% + 4, CHR$(177));„   NEXT„   LIN% = LIN% + 1: COL% = COL% + 2„   WHILE lim% = ex%„      COLOR 9, 1: LOCATE LIN% - 1, COL%„      PRINT MID$(STR$(sel% + 1), 2) + STRING$(3, CHR$(177))„      FOR t% = 0 TO (high% - 1)„         LOCATE LIN% + t%, COL%: COLOR 1, 3„         IF t% + top% = sel% THEN COLOR 0, 7„         PRINT LEFT$(txt(top% + t%).l + s$, wide%);„      NEXT: p% = 0: p$ = " HPIQGO" + CHR$(13)„      WHILE p% < 2: p% = INSTR(p$, RIGHT$(INKEY$, 1)): WEND„      SELECT CASE p%„         CASE IS = 2   'CURSOR UP„            IF sel% > 0 THEN sel% = sel% - 1„            IF sel% < top% THEN top% = sel%„         CASE IS = 3   'CURSOR DOWN„            IF sel% < (lim% - 1) THEN sel% = sel% + 1„            IF sel% > (top% + (high% - 2)) THEN top% = sel% - high% + 1„         CASE IS = 4   'PAGE UP„            top% = top% - high%: sel% = sel% - high%„            IF top% < 0 THEN top% = 0„            IF sel% < 0 THEN sel% = 0„         CASE IS = 5   'PAGE DOWN„            top% = top% + high%: sel% = sel% + high%„            IF top% >= lim% - high% THEN top% = lim% - high%„            IF top% < 0 THEN top% = 0„            IF sel% >= lim% THEN sel% = lim% - 1„         CASE IS = 6   'HOME„            top% = 0: sel% = 0„         CASE IS = 7   'END„            sel% = lim% - 1: top% = sel% - high% + 1„            IF top% < 0 THEN top% = 0„         CASE IS = 8   'ENTER„            lim% = sel%„      END SELECT„   WEND„   ScrollBox% = sel%„END FUNCTION„„Claude GagnÇ                   MENU SYSTEM                    cgagne@globalserve.on.ca       05-17-96 (11:47)       QB, QBasic, PDS        581  20166    MENUS.BAS   '*******************************************************************„'* This is some routine from my own library                        *„'* Use the tab key to navigate into the menu                       *„'*                                                                 *„'* Some routine are written in French because I'm from Quebec      *„'* Excuse my english, I'am learning since only 5 month             *„'*                                                                 *„'* You can Email me at cgagne@globalserve.on.ca                    *„'*                                                                 *„'* Feel free to copy or modify these routines                      *„'*                                                                 *„'* Claude GagnÇ, Toronto (since 5 month ) 1996                     *„'* If you want more, Email me!                                     *„'*******************************************************************„„DECLARE FUNCTION yesnobox! (msg$, default%)„DECLARE FUNCTION menusystem! (menuitem$(), handle$)„DECLARE SUB cadre (gauche%, droit%, haut%, bas%, couleur, ombre, coultitre, titre$)„DECLARE SUB dayofweek (range, colone)„DECLARE SUB Delai (ticks!)„DECLARE SUB click ()„DECLARE SUB messagebox (msg$)„DECLARE SUB appuietouche ()„CONST vrai = -1„CONST faux = NOT vrai„'******************************„'* String array for the menu  *„'******************************„„DIM menu$(6)„menu$(1) = "  File  "„menu$(2) = "  Edit  "„menu$(3) = " Option "„menu$(4) = "  Color "„menu$(5) = "  Help  "„menu$(6) = "  Quit  "„„'*****************************************„' Demo Here                              *„' Erase this part and put your code here *„'*****************************************„„CLS„cadre 1, 80, 1, 23, 15, 0, 1, "Desk ( box without shadow and Dayofweek routine)"„dayofweek 1, 1„„LOCATE 21, 12„PRINT " Look the transparent shadow !!!!!!!! "„cadre 10, 70, 10, 20, 7, 1, 1, "Box with shadow"„SLEEP„cadre 15, 65, 15, 18, 3, 0, 1, "Box without shadow"„SLEEP„answer = yesnobox(" This is a Yesnobox, do you like it! ", 1)„        IF answer = 1 THEN„                cadre 1, 80, 1, 23, 15, 0, 1, "Now, the Menu System !"„                SLEEP 2„„                menuanswer% = 0„                DO UNTIL menuanswer% = 6„                menuanswer% = menusystem(menu$(), "Main Menu")„                LOOP„                cadre 1, 80, 1, 23, 15, 0, 1, "This is it !"„                messagebox ("That's the end of this demo")„                „                „        END IF„        IF answer = 2 THEN„                CLS„        END IF„END„„SUB appuietouche„'****************************************************„'* Wait until a key is pressed                      *„'****************************************************„„CALL cadre(20, 60, 20, 21, 7, 1, 1, "  Instruction...")„„COLOR 0, 7„LOCATE 21, 28„PRINT "Press any key to continue..."„„DO„LOOP UNTIL LEN(INKEY$)„„END SUB„„SUB cadre (gauche%, droit%, haut%, bas%, couleur, ombre, coultitre, titre$)„'***************************************************************„'* Box routine like CPAV                                       *„'* Claude GagnÇ, cgagne@globalserve.on.ca                      *„'*                                                             *„'* gauche% = left : left col                                   *„'* droit% = right : right col                                  *„'* haut%  = up    : up row                                     *„'* bas%   = down  : down row                                   *                                             „'* couleur= color : color of the box                           *„'* ombre = shadow : 1 = transparent shadow                     *„'*                  0 = no shadow                              *„'*coultitre= color of the title                                *„'* titre$ = title : text on the top of the box                 *„'***************************************************************„                oldgauche% = gauche%„                olddroit% = droit%„                oldhaut% = haut%„                oldbas% = bas%„„         IF ombre = 1 THEN„'*******************************„'* Vertical shadow             *„'*******************************„„        FOR i% = haut% + 1 TO bas%„                FOR j% = 1 TO 2„                        car = SCREEN(i%, droit% + j%)„                        car1$ = CHR$(car)„                        car$ = car$ + car1$„                                IF car$ = CHR$(219) THEN„                                        car$ = " "„                                END IF„                       „                        LOCATE i%, (droit% + j%)„                        COLOR 8, 0„                        PRINT car$„                        car$ = ""„                NEXT j%„        NEXT i%„'********************************„'* horizontal shadow            *„'********************************„„        FOR k% = gauche% + 2 TO (droit% + 2)„                car = SCREEN(bas% + 1, k%)„                car1$ = CHR$(car)„                        IF car1$ = CHR$(219) THEN„                                car1$ = " "„                        END IF„„                car$ = car$ + car1$„„„        NEXT k%„        LOCATE bas% + 1, gauche% + 2„        COLOR 8, 0„        PRINT car$„„„         END IF„„„„„                COLOR couleur„                LOCATE haut%, gauche%„                        PRINT "€"„                LOCATE haut%, droit%„                        PRINT "€"„                LOCATE bas%, gauche%„                        PRINT "€"„                LOCATE bas%, droit%„                        PRINT "€"„                ligne = (droit% - gauche%)„                motif$ = STRING$(ligne + 1, CHR$(219))„                ligne1 = droit% + gauche%„                      „                                LOCATE haut%, gauche%„                                PRINT motif$„                                LOCATE bas%, gauche%„                                PRINT motif$„                                FOR i = haut% + 1 TO bas% - 1„                                        haut% = haut% + 1„                                        LOCATE haut%, gauche%„                                        PRINT motif$„                                NEXT i„                                  COLOR coultitre„                                  LOCATE oldhaut%, oldgauche%„                                  PRINT motif$„                                  titre% = LEN(titre$)„                                  titre% = INT((ligne1 - titre%) / 2) + 1„                                  COLOR 15, coultitre„                                  LOCATE oldhaut%, titre%„                                  PRINT titre$„„„„END SUB„„SUB click„SOUND 800, .05„„END SUB„„SUB dayofweek (range, colone)„'*************************************************„'* To find the day of the week                   *„'* range = row                                   *„'* colone = col                                  *„'*************************************************„„Month = VAL(MID$(DATE$, 1, 2))„day = VAL(MID$(DATE$, 4, 2))„Year = VAL(MID$(DATE$, 9, 2))„DIM day$(7)„                day$(7) = " Sunday "„                day$(1) = " Monday "„                day$(2) = " Tuesday "„                day$(3) = " Wednesday "„                day$(4) = " Thursday "„                day$(5) = " Friday "„                day$(6) = " Saturday "„„    IF Month < 3 THEN„   „      Month = Month + 10„      Year = Year - 1„    „    ELSE„      Month = Month - 2„    END IF„  „    Y1 = Year / 100„    y2 = Year MOD 100„    dow = ((day + 2 + INT(2.6 * Month - .1) + y2 + y2 / 4 + Y1 / 4 - 2 * Y1 + 49) MOD 7) + 1„„SELECT CASE dow„        CASE 1„               „                jour$ = day$(dow)„        CASE 2„                jour$ = day$(dow)„        CASE 3„                jour$ = day$(dow)„        CASE 4„                jour$ = day$(dow)„        CASE 5„                jour$ = day$(dow)„        CASE 6„                jour$ = day$(dow)„        CASE 7„                jour$ = day$(dow)„END SELECT„Month$ = MID$(DATE$, 1, 2)„Year$ = MID$(DATE$, 7, 4)„LOCATE range, colone„PRINT jour$; day; "/" + Month$ + "/"; Year$„END SUB„„ SUB Delai (ticks!)„ 'The next sub is just a little delay„ '„    begintime! = TIMER„    DO„         LOOP UNTIL TIMER - begintime! > ticks!„END SUB„„FUNCTION menusystem! (menuitem$(), handle$)„„'******************************************************************„'* This is a menu routine using a text button                     *„'* Use the TAB key for navigate                                   *„'* Menuitem$() = string array containing the menu items           *„'* Handle$ = Title of the menu. It appear on the top of the menu  *„'******************************************************************„„DIM colone%(UBOUND(menuitem$))„„PCOPY 0, 1„CALL cadre(1, 80, 1, 4, 7, 0, 1, handle$)„„oncontinu = vrai„default% = 1„answer% = 0„„WHILE oncontinu = vrai„        col.depart% = 1„        row% = 2„        fond% = 7„„„        FOR i% = 1 TO UBOUND(menuitem$)„                longueur.bouton% = LEN(menuitem$(i%))„                longueur.bouton% = longueur.bouton% + 2„                haut.bouton$ = STRING$(longueur.bouton% - 2, "ƒ")„                bas.bouton$ = STRING$(longueur.bouton% - 2, "ƒ")„                fin.bouton% = col.depart% + longueur.bouton%„                colone%(i%) = col.depart%„                CSG$ = "⁄"„                CSD$ = "ø"„                CIG$ = "¿"„                CID$ = "Ÿ"„                verticale$ = "≥"„„                LOCATE row%, col.depart%„                COLOR 15, fond%„                PRINT CSG$; haut.bouton$„                LOCATE row% + 1, col.depart%„                PRINT verticale$„                LOCATE row% + 2, col.depart%„                PRINT CIG$„„                COLOR 0, fond%„                LOCATE row%, fin.bouton% - 1„                PRINT CSD$„                LOCATE row% + 1, fin.bouton% - 1„                PRINT verticale$„                LOCATE row% + 2, col.depart% + 1„                PRINT bas.bouton$„                LOCATE row% + 2, fin.bouton% - 1„                PRINT CID$„„                        IF i% = default% THEN„                                COLOR 14, 7„                                LOCATE row% + 1, col.depart% + 1„                                PRINT menuitem$(i%)„                        ELSE„                                COLOR 0, 7„                                LOCATE row% + 1, col.depart% + 1„                                PRINT menuitem$(i%)„                        END IF„„                col.depart% = fin.bouton%„              „        NEXT„                C$ = INKEY$„                C$ = RIGHT$(C$, 1)„„                        IF default% > UBOUND(menuitem$) THEN„                                default% = 1„                        END IF„                        IF C$ = CHR$(9) THEN„                                default% = default% + 1„                        END IF„„                        IF C$ = CHR$(13) AND default% <> 0 THEN„„                       „                                CALL Delai(.03)„                                haut.bouton$ = STRING$(LEN(menuitem$(default%)) + 1, "ƒ")„                                bas.bouton$ = STRING$(LEN(menuitem$(default%)) + 1, "ƒ")„„                                LOCATE row%, colone%(default%)„                                COLOR 0, fond%„                                PRINT CSG$; haut.bouton$„                                LOCATE row% + 1, colone%(default%)„                                PRINT verticale$„                                LOCATE row% + 2, colone%(default%)„                                PRINT CIG$„„                                fin.bouton% = colone%(default%) + LEN(menuitem$(default%)) + 1„„                                COLOR 15, fond%„                                LOCATE row%, fin.bouton%„                                PRINT CSD$„                                LOCATE row% + 1, fin.bouton%„                                PRINT verticale$„                                LOCATE row% + 2, colone%(default%) + 1„                                PRINT bas.bouton$„                                LOCATE row% + 2, fin.bouton%„                                PRINT CID$„„                                click„                                CALL Delai(.03)„                                answer% = 1„                        END IF„                        IF answer% <> 0 THEN„                                CALL Delai(.03)„                                oncontinu = faux„                        END IF„„                      „      „WEND„„menusystem! = default%„'PCOPY 1, 0„„END FUNCTION„„SUB messagebox (msg$)„'**************************************************„'* Print the message into a box and wait until a  *„'* key is pressed.                                *„'**************************************************„„PCOPY 0, 1                      ' faire une copie de l'ecran precedante„„'****************************************„'* Calcul des limites de longueurs      *„'****************************************„„longueur.msg = LEN(msg$)        ' length of the message„depart.box% = (80 - longueur.msg) \ 2' column start„fin.box% = depart.box% + longueur.msg + 2'column end„„'****************************************„'* Appel de la routine cadre            *„'****************************************„„CALL cadre(depart.box%, fin.box%, 12, 13, 7, 1, 4, "Attention !")„LOCATE 13, depart.box% + 2       'Locate the box„COLOR 0, 7„PRINT msg$„'****************************„'* Boucle d'attente         *„'****************************„CALL appuietouche„PCOPY 1, 0                      'Restaurer l'ecran precedante„„„„END SUB„„FUNCTION yesnobox (msg$, default%)„'**************************************************„'* Print the message into a box and return the    *„'* answer!                                        *„'* msg$ = message to print                        *„'* default% = answer to be highlight              *„'*          1 = Yes                               *„'*          2 = No                                *„'* return:                                        *„'*          1 = Yes                               *„'*          2 = No                                *„'**************************************************„„PCOPY 0, 1                                      ' faire une copie de l'ecran precedante„oui$ = "Yes"„non$ = "No "„answer% = 0„'****************************************„'* Calcul des limites de longueurs      *„'****************************************„„longueur.msg = LEN(msg$)                        ' length of message„depart.box% = (80 - longueur.msg) \ 2           ' column start„fin.box% = depart.box% + longueur.msg + 2       ' column end„'****************************************„'* Appel de la routine cadre            *„'****************************************„„CALL cadre(depart.box%, fin.box%, 10, 16, 7, 1, 2, "Decision")„„LOCATE 12, depart.box% + 2                      'locate the box„COLOR 0, 7„PRINT msg$„oncontinu = vrai„„WHILE oncontinu = vrai„„C$ = INKEY$„C$ = RIGHT$(C$, 1)„'****************„'* bouton Yes   *„'****************„                COLOR 15, 7„                LOCATE 14, 31„                PRINT "⁄ƒƒƒƒƒƒƒƒ"„                'COLOR 15, 7„                LOCATE 15, 31„                PRINT "≥"„             „                LOCATE 16, 31„                PRINT "¿"„                LOCATE 14, 40„                COLOR 0, 7„                PRINT "ø"„                LOCATE 15, 40„                PRINT "≥"„                LOCATE 16, 43„                PRINT "ƒƒƒƒƒƒƒƒŸ"„'*************„'* Bouton no *„'*************„„                COLOR 15, 7„                LOCATE 14, 42„                PRINT "⁄ƒƒƒƒƒƒƒƒ"„                LOCATE 15, 42„                PRINT "≥"„            „                LOCATE 16, 42„                PRINT "¿"„                LOCATE 14, 51„                COLOR 0, 7„                PRINT "ø"„                LOCATE 15, 51„                PRINT "≥"„                LOCATE 16, 32„                PRINT "ƒƒƒƒƒƒƒƒŸ"„„„        IF default% = 1 THEN„                COLOR 14„                LOCATE 15, 33„                PRINT oui$„                COLOR 0„                LOCATE 15, 45„                PRINT non$„        END IF„        IF default% = 2 THEN„                COLOR 0„                LOCATE 15, 33„                PRINT oui$„                COLOR 14„                LOCATE 15, 45„                PRINT non$„         END IF„         IF answer% <> 0 THEN„                LOCATE , , 0„                oncontinu = faux„         END IF„„                            IF C$ = CHR$(13) AND default% = 1 THEN„                              „                                click„                                COLOR 0, 7„                                LOCATE 14, 31„                                PRINT "⁄ƒƒƒƒƒƒƒƒ"„                                COLOR 0, 7„                                LOCATE 15, 31„                                PRINT "≥"„                            „                                LOCATE 16, 31„                                PRINT "¿"„                                COLOR 14, 7„                                 LOCATE 15, 33„                                PRINT oui$„                                LOCATE 14, 40„                                COLOR 15, 7„                                PRINT "ø"„                                LOCATE 15, 40„                                PRINT "≥"„                                LOCATE 16, 32„                                PRINT "ƒƒƒƒƒƒƒƒŸ"„                                COLOR 0, 7„                                LOCATE 15, 45„                                PRINT non$„                                reponse% = 1„                              „                                Delai (.1)„                                answer% = 1„                               „                            ELSEIF C$ = CHR$(13) AND default% = 2 THEN„                                        click„                                        COLOR 0, 7„                                        LOCATE 14, 42„                                        PRINT "⁄ƒƒƒƒƒƒƒƒ"„                                        COLOR 0, 7„                                        LOCATE 15, 42„                                        PRINT "≥"„                                   „                                        LOCATE 16, 42„                                        PRINT "¿"„                                        LOCATE 14, 51„                                        COLOR 15, 7„                                        PRINT "ø"„                                        LOCATE 15, 51„                                        PRINT "≥"„                                        LOCATE 16, 43„                                        PRINT "ƒƒƒƒƒƒƒƒŸ"„„„                                        reponse% = 2„                                        CALL Delai(.01)„                                        answer% = 1„                                       „                            END IF„                           „                            IF C$ = CHR$(9) AND default% = 2 THEN„                                        default% = 1„                            ELSEIF C$ = CHR$(9) AND default% = 1 THEN„                                        default% = 2„                            END IF„„„                            „                        „WEND„        yesnobox = reponse%„        PCOPY 1, 0                                      'Restaurer l'ecran precedante„END FUNCTION„Jonathan Leger                 WINDOWS DEMO                   leger@mail.dtx.net             06-04-96 (22:06)       QB, QBasic, PDS        124  8212     WINDOWS.BAS DEFINT A-Z:DIM SHARED K,S,B&,Z&:V1 'Created by PostIt! 7.2„SUB V1:OPEN "O",1,"WINDOWS.ZIP",4^6:Z&=5890:?STRING$(50,177);„U"%up()#9%%Om-%M)o=Ebh4&jr-%%%9G%%%0%.%%&n#sit&%xSgfOxf(*8>GD6qM.„U"BxMpC34[>#$EoY0QSRm=\,;6(,WMk;arHlIU\#>Rq*pb\Fu]'aICEv0Da;VLCj#„U"oANNUJ,NBKb&2'BT_wAJQ*Uhu'(dOq.&P5WUIK:'\*'%W9VlZlLGVgKgnrztNfe„U"aV^u1])4?Zw?YOd,rI^Z#gG39=:g7lP#S&WO;v:I#I*6OM:XW1'.V)w'%mVzfTA„U"HiHg9+TU2Vp_ueABWQdr5-^:?_Ue#*Gi(FZ[%Y'H9i(NBHwN4-II(Vba>4;Oa$%„U"b0^%7b30-Bq[owg_Z*)480W?#;$Y#acK;Qm/py,%&_awgR?-&m5%o)m)*ri<T&o„U"w:iphk1Zj[-DVEMJRu?GHFW(54#rRQgPsLINCYCFUtMh*U'i86mwu(XvbY?A^53„U"B#YW><:uT8d^NCru/U/gEr,>B.I#K%Qh<Bh(U7=-mI^1XRX]po[_CJ&u;tF7AYc„U"NnbaJ<2%yq+$l(7S%&CoVjF^1P>pELd<5Ae^,%+qH%q97gmjF3_DR/=?^DQ53W6„U"n.*94%$hQa78k8Ec9PA?&lVbI[A=1=vd=8^&sAPgh:OsI8EK-^w:tHlHMz8#t12„U"CWdA42UP[9p1g?C18us2/W5^N*I%3]$=1/0#QyM1c$wiU&?U0T;#YjhEgfW_*)m„U"GqV;pBAn_a$mf-?-k9dVLxIG)H*ItF>4hocef-#/r[D$s<$Cr?vV)w$?v)E+nVC„U"2L=WE*_%6PlDe('GYE,B:9oUJmYi>Z.DOMS<b<A^sfYb'k8[3NuSKOrb'2)=(tB„U"rNCA?^QYHnNPR%%#n0#5CQ7wC:\VskhuBdPsd4o=fOeXVy(lr3;skvblJ>.z1k0„U"Nk;b[W6uHlLD?qc*<tTn(sCO<)MpQxm[VrnK?<6s;wdGMs,]DyJ>eB$C;6o%C:X„U"Odva5lUD6%dzD8\S.cv]E)+0zh-k#hs-worJ&Yy9VH1h$s[wnloh.DDl*cd[G[t„U"l?tFph4.$A%LOLIv&ZF84Z<9FmssiEuoH$6GFNx)ktGAXQ\.U+pkA+KaDH<?x=R„U"=lk7U_%A&VpO7_o7CM$pm:-ceEVRT=fATaB5wHG&TQ-$^UBBv/Xn+o*q:0aXhh&„U"EPzRR5,rTW3iRG$appfUejL6I[+?J\Zt?lF^XK_7r>DhoSKHT->kekhD<a=5ju<„U"E+)GPW*MR&-L4m.uN,S?3_?1sSix5w+mgLZv7wc0;u0o/1P&sD]1-[?DYmQ)7]p„U",cD4>ZcO6D%9Wp?J;pzzjQV*Dgw1PhpIsgK#APO3$2[1VM*47Do6yRtn]gc2.ph„U")u8W=E[MCNdpADPDe]a/$Yqd$o_;V5XDbE;wYAQ8;#:;li*3C%%Pdp39.Q4&VLU„U"y,cIjpty00;.^hqhF:s4M&Zx.U)]y?We-$Df%bmW[jF]aP4=<csDO1Jw[Z7-laY„U"#i6exiKVHGNkX$jMb*#.Q/J>/VeYJq1>U*7z^QF6aaqd7\R+9LEThe(r68\5y9;„U"0B>f:VO:jU&z*$au_NhyHZgPIa4Yh:E2cKPVZcBJ34\gQhQI.wX<P$L7C<)Qh-g„U"PA$6xbq6\&&ZyV?5L77(?gB?r'0'+HFKRe#[>&#[Y0Dof/T87^RKd;d3]#E3NI2„U"2/6PPkn?%KtA_Vt;f,ukK(M94wst&-7VN_4zDUvYF$7r,[l$YIZKmd6io7Q.\00„U"CV*7]D,LDjct]\mA<$HUX_'2Mamn<l517vT-,*l/2-9QB9UQF;rLuNL)FH1#5y;„U"Id_4t'IW+uZHg1MaGV5TcI78M>5EXb**Ha'tkYx+iT8Uk^j3t1EWLOxFKq.H9ku„U"ngJIN3(9Z_V,IK-(6:$%mQ.lnirt)kY\wQPJYgFRjGiP8'9Gq'ft-q6h^TRW^PO„U"ERy>*_&PrQUl=&T/k*.?Z<gRgi0#2wO/7A]6$)YVGG2a:n7tts^I<b&KT8JUrLN„U"OFEI5l37\B5G1qp;O0S^xj#ghKBe<Mz>_rgyMegyx_LkgVM)Eh_y$4/_**Q[Z^t„U":0%1+4OGM)CX5R>>Fb0d(VhaJZ6[_=J&O/&yku?\.pX>SDeEQIO8[8#[JbkO5Xk„U":8kg8n1P5)sNwKf8kD(5dAh_Y8oP:3&HPi/MQi_s%&x97RH2m/I&%P_4,UhpC#j„U"P[]le.&JOuv'0N)T12FMNO*?W7,ZMF++]$Ya]f(gk2k4^.dDq\O.Smb,vuMs^6J„U"M+X8Z]H16<e3&>5oaKgap1VQqalZ7OS8mo)K3kDDb8_Ke^tG$QX0A3LJ2V/E,jV„U"YWdnvb;*M[LR_j1?[+Ag6Y3)&ir>)*Di:bJ((=Vs.e*DC^\gYB)oW>;T(KHWswR„U"PF2^T3Jjn3iX_V>W)qA/o-AF%yeMq=&8ZWk<;go^pP)aMhX87cKVAb,L$R[mw/w„U"VRS=7\d#nrT+Q6$dKVQtg]]JLRD3wX2n>5r']psInpt1K.g-wBh>ZTeNj,rOcSe„U"w&1V>uSl#,ncj%XmVEmjRnICi\YQc_x[/K>8<-g0kb_$\2cZjF.ua8P4>cZ(r_7„U">LV#H'Hf>>5PZs=+]d6v7Vd7F&-#-FfvE31-cLL/#*GqGNt*<z,H=j+f<\h[3Xu„U"cCsrtB\IYqhH5A#%aOc*aPV_8eYDS=(sc>hR_Svk,XAH95Vq6,q-#A/9DWwX2bR„U"jVOEpnj)0hmZix=tGX(MA-ZlYZ5si2zkeW7WR'aMyyucE)PNw3E1Ia7jx4AtnHV„U"HoLjWN5uE,mRsah*6&0tztC7APixJSvT9X[ve#la0..]Rm?J\uc5&0gDg03;Ch-„U"q/d?RgL]cDg+Zl[+ed43-*<WS3#P+DKH85BmX[<$KmD%up()#9%%O.-%>p9JEam„U".4GT2.%%Wb%%%0%.%%&n%sijr%tSgfaxf#DtATAj9'Ovh3TtYn_h1-iURf,$4MS„U"%QppYB=u4RS</W=XMDbO/OXQj4ARmOhRX4B:vCay7vjO8ab/m>/+lYDa+_Xbu[s„U"0agb?pmm1pD<Xb6*2P)s%YFZZj:BjLfDN>sE7feMWf-GU^ZuZ\#'s0<TQ,>BuE1„U"'(W5&A'j0C&&g);c]s$x_LtE0Qs]X#HRzT2x%+aV-iU,SZ$Q^&=&bfQmGV$%D8O„U"M5oruO#Y?jQ8-T1,$0.)Jv1:VJ$,C<U-W7\ouUjeU3EI&7Mb.eaY]44=f5YSY9q„U",WFO%+J01i7PHYj'e?nWAXMcJBZZ7J$#q>WVWbRS0#'h*:Ccc*I'6^b(UaI)qJQ„U"RD%UW^wf5-%+5>NJw?[_?fuxRZjO5oEMXG8n]Wo-p03irL=C-5+A6eK\xhPhGW6„U"1[,auH'GH,H-zOMf<krM_HnY\BEYqUky&O7Hy>*mK#6&B9%:(;PGE)h7]U9chjE„U"ZZ;CjeaePICdM9xrnOt<MLVAQ]E<c&008aJ'4vW\*ijHRp(KkjNsmg_Y2aB>MV;„U"+1BRAKwW14W16n\S8[b#ES1&sO%3Y.:YT#%^%xE]LwxK,zA/JG']*n--\'.&x.(„U",u*+qeB2gO.?U<2D2'V1'P9+R(:&=I<P)nf,w5HS4x-0]6:ngJ_^1]\e2&U1$Ly„U"=JCU9Rth]]oZ0('^l:&6B=d]#\N%E:I5+e=TL5;=X8SHhIKkEk)s[Ma*[?4.2&_„U"/I<VcVU]gSN^MnrPadSg<+7BGAU$j=#/(-NsU2Xc4S&L-:sg4GQ5Lwma5=+3iB9„U":27%oRWW+jCd?:7I1:pqQ];C3#n&Vi9;ZX\D-gh23;Jorf'WCa99A:aE+2Pgbe\„U")f)m,TrEDOxH:)>-ACunZiq54xzR5p:V4bFZrxNq/Br)FAIY]TKSEIu8qLRZ=o.„U"(FAc1.\\[qgIU#>AN0lyK]Hv;PP3<Qk<OZ)n=C/RCE'NPp2*H<d_wjAYRT-04#l„U"Ge)/3G4<Uk#)#'H<H-YOaSF9<[3ejET/OVp7LrSX(%e2)2C;geuEU.p&aK4%CET„U"S'Mgg$%8XL%,xLg(EtoJ<;e:Xd#<AQf$g'-'vA<sp-(m2JId%GR9D#5gCW+Ve_;„U"b-iKS.&y_[)-BsSAYlmoU/L?5<ps.\%dc=Y0*$*JA'mFaQjd*QJQ%w7IUa\;ZeW„U"r\AdQKwQN8hbq?;9m.(o'F.SqKEyDl6QfD?iYmR=S/okAWo+_$b,DL^QGb\G[yG„U":*?E_9v<#Yu&hAuEPg\w)8GJhYbYk#tCDs_5]>lvUJbjAg*y4)0lMk7/BXvqsj(„U"q[h%5=RSwx(1B%v.XXK2qaP^uBn,JY,Ug=MDMB('AmK\iM?<kU_eC^(WR&W9sUC„U"Vh%k2#/mLU-wK%RS$1FQ:.nzK2:/n8ji'G\[+]p/r]P6=8-+U#P.&1,s#75^w]]„U"ET;P15CfQM5]Rb2X_#_Z8:wYMh)uf/5'+=Gu6+I/>S$Q0Ye0*H,ISE<ZpFqdAIt„U"7PJ.[X4W9PUsG1S3?b[6ElB>g5\G+/('4FkZI[g%ml56gDd)^&3iInT9aw5-htu„U"lRS^f_J'naoN)jk82[jbelIg)\d($I-Ml,^G^,0NHqip+FuNAG:1=&N_-ls4hk.„U"(wagufBZb-=Lbw4)NmOevwQ<(W%<FoNNn*H34ui0p8IjMvRHp4RISD/-MXOw=WE„U"f=[1i4*Os?Vt8GFyPr892sTCH*70N,HxX?i*$\QbxXw?=d7xZEJA1)q,J=?sSur„U"<KH.y=27q#ps>xmZm\iDFh7D:okWF,q-qjDDIdG'fSce(==bte9L.NsvUg$\j*(„U"Bvc-w6]oG<WMJT:1;3KEHdv?W*B:\f>L[cjNI:JK:S?.;km%j_\gOjMcyaf:lM9„U"M^G?$G[ZN54fQP#evQ-J>XNs46/:t>bJIdcrpUIT4#mDf6(qtp4ssdCH<i7xV2D„U"TJEjI0Lf8QGP)bC[WbeXr5(j/WQRqg(KfHGSg$+OuVXZa-A>Co<I0#u<bJU_4*L„U"uFToCs66,tvTCa%wYS:6-V,lXuk^4JQ_,F1BU3mJRN8Lhds\.^ItQiW&gM(*a2[„U"hbUCmI]?Ofdcd2o\e*WxddQYx>(54Ux-I_Of*4UdQKY:EwVoDdHZImlA#JQI;CN„U"pmvDwSt/Q//i(Rwux7WI.'r9sgN#?UPV:Fo1BdT5/Ov(g4_JS?q^ApJdN\ki7ke„U"DG1;2)'N>*4<N5V.rCA.dk:M3X-LSI2qWlkqM_&aOK[e,]gGFe4JF?'PiJC.E?E„U"w8)Ubv.(TwZgn(7mH2D,\j4\NxkNF:z:]Rh;PDILd0n#G2<kM.-B#6ZRupNt/_I„U"8MWXmi-hihh5Cq;qN%>XHa<qL1m-AFKPF[K?Q1r^)*1eUA&(u]71_7W92J*<1Wq„U"Q\,,-Q=>)DpoGG%KKH]Q8DXy?.eIeVsjqkYYkFIJVKhDf5,ABK1fjb?U=3j(53U„U"UPFADfc5;11russ6H5ax?Z2U^M_PeCBlm<ihc>'GqDh&qw'YE<1ZioDDD1/ZBRm„U"htuvn2_%d97u,V8[#JXr_(gIZtcHng1^-?T^S?LtW$[xXte8.R8Z[P+TxamSbHc„U"ki/#hz]]Ew\g,ka6/E5(HIawP;YQ4lcY=\-cMCG=;7O6>c&1*H'\9p.FWsh0+Rg„U"TXh%1n(&6tj+0U)WTQ0Oc+JB??=u=pL5cL<^7R[YG-E:PAFvDX\]g0<vnoXPSYA„U":2Oe-V%_v_9<FlMIgF_8'C64YH[7;J-gPi7G[JW45TmWnwSyE0PJ#L'Iu&R-[IC„U"=0/NnX_)*Ok8<jkZCCM?.2[kHK7'(E:io9I<QQHZ;IIplWJ/47/jy7<L9LH$1d1„U"DEk)2u+b]^ftqz4sZTpMkrJ*7FUadV5vil<itl)FeAZDbIN1\LHiE=m&V$]Pqu]„U"mJAw.w60,)\BCK;'tUs<T<5e0B0-?>9ALgvHWu/ZK],%2Z*?%O_Q?n,.c-'gV;D„U"DbtQGS$OS%\\+omBL$$GGc%$Lp'x093<QB,y%p\>]Cxi8>,4&588>7q]g2#gT*h„U"=2wC0_d.e+o$;z%#2?E04W4tboFZ,uk<J]\1En9J5E3k.i7ORvEXLg-:U>_Nb=U„U"[-lbwed^0LUif4=QV5e;GATCvU'NT#HVU&$2=P4.IP2lRKs4U>tLbbfQo*?mtQ7„U"'uVsJhJR-bZNZ:%+nLIR,dNYhK6>BYZA_6&MpyOc1mfptJjF-G8lC*E7Bu^wucM„U"EbUyw,t<u('gV;RQ+R/u>UN/oKNh[\#>cFl5#YsjqS^tHeF.N_<gl/Hy7q+)00k„U"GflH6xq<I/l_44h*?X;6),Xvh5iJ7lS>ja$C=R0L'#9HpS*A^gC#hbHHU/9_%oJ„U"w5#DuHr0#]OX2*2GQ,3x?:W8WUIdvzrN0KEX-YNJ#fRPD972JAjc_=4WG1Wj>n[„U"x61&DpV2Jx=pOiwx9>Z&MHfheMc3=037(6BTxa0FFgUd7chq%<=9wLJ.g%$)^Im„U"ZXj9';w?H1Y*K[Rek.&T?22my[gSEP.bQDD2BG)v3YognJ\(2E6;wi/&\v=kAmD„U"UkGUnKn1zhwgTc#2hBHy+Qo(x?8KJZ%K;DuGuS03H&G*1$U-$PGd_[CW.IPQbOV„U"-^[PL#s5%Xos%]8]76gTj8S[\rwoF#w8F&_3%uT]pzPv<8)sD;weOObfeg$7^t+„U"_jF&=eiAr4G7:^%TCXb1ucTPq-hRT*_]l0L4d57q]^SwK=t88x+<-y7OR;uxLm:„U"ywI)kk'BI^L(VrVGEL8BS1UDcD2mNs7(_3cO-Z?4XG?iDCI>[KAgEntK2)0MMX*„U"CGmd8Q[M7P*cAr3;/OR11-B?=A0R]hdz1w/I*j4Y3%'y+(u6fzerG[)-1p.8b1Z„U"uff+HeE.]saCYw=<bf?+z1V=5*H=$%2sIIp:.C:RK83d0(d,N,uO3)/uzdHqwe3„U"Vyw(MnZ?dTM=X+TCSQJV_00dK,<t(_5$^;%QYv35=:7*d8R&VmLA-Ep>>G-nE<\„U"Bj-tC\Rv)M>e<b\wo(\X6WT:^HWDk:A5jXFYh'\CoQbo9yqBF0-8fkx1uf.kEP:„U"G-Bl;Z]R_#],%elBlGklKrLcvu1/lkY#G>/2,-$p_6$(u+dH6WO1Niw67+ZN$8B„U"L[jbUBwBJWps:0.;(Yx><S;nVkK.b'V^J]:+zlLW\njX.;?g7H5N3r3ZB4rn-ee„U"0.su6Ho#+h_a2jx%B+^wG#>p7sLp$\Tpse$+Wk)EIJoXvbs26fUA0NAJ,%Lj<IF„U"t)^7n&)9)?msq%$/pjF=-ujxkEFpL>2V[J?#5MS,+JU3,mR]^'vQaP#<=pM;%H0„U"+/j7.6k6;umF0QXm)+2e<g_eA,kesc?n>7gO'QXtVn0,Ca>8f9vNx'W+jS<FbGw„U"(y?35d:I'u8up%&'9%%9%%%m-%M)o=Ebh4&jr-%%%9G%%%0%%%%%%%%%&%%E%%%„U"%%%%%&&nsi(t&xS%gfxu%p&'9%%9%%#%-%>apJEa#m4GT#2%%W%b%%0%%%%%%%%„U"%&%%E%%+%E-%(%&ns%ijrt%Sgfx%up*+%%%%%%'%'%&A%%%&I;%%%%%„END SUB„CLOSE:IF S=191AND B&=Z&THEN?" :) Ok!"ELSE?" :( Bad!„SUB U(A$):FOR A=1TO LEN(A$):C=ASC(MID$(A$,A))-37:IF C<0THEN C=91+C*32„IF K<4THEN K=C+243ELSE?#1,CHR$(C+(K MOD 3)*86);:K=K\3:B&=B&+1„S=(S+C)AND 255:NEXT:LOCATE,1:?STRING$(B&*50\Z&,219);:END SUB„Charles Godard                 OPEN UP TO 16 POPUP BOXES      FidoNet QUIK_BAS Echo          06-24-96 (00:00)       QB, QBasic, PDS        274  8798     NEWPOPUP.BAS'NewPopu1.bas by Charles Godard, 06/24/96„'Popup boxes over boxes; 16 open at one time!„'<<<<<<<<<This Version is made for Qbasic>>>>>>>>>„'Many thanks to Gary Godard for the suggestion to use the ScreenPram„'and for a good explanation of how to use multiple dimension arrays„„'No Border = 0, single = 1, double = 2„'shutUP by itself closes the last box opened„„'The number of Boxes% open at once, depends on Dgroup Memory available.„'I have tested it up to 15 boxes open at one time in this program.„'Each box requires 4000 bytes. That's 2000 for the character and„'2000 for the attribute times the number of screens open at once.„'You cannot exceed 64k at one time with all routines including„'whatever else your program is using.„„'This program will also run in QuickBasic, and you can have as„'many as 70 boxes open using far memory.  Just redim boxes to 70„'and start adding more boxes to your program. (depends on far mem)„„'I re-coded this as a Qbasic program, because I remember when I„'was first starting out, I was disapointed because I thought that„'Qbasic was so limited in what it would do, that I became discouraged.„'(I didn't have a good conference like this for encouragement.:))„'And I keep seeing msg's from guys who don't have QB.„'Altho I certainly like QB better, there is still a lot that can„'be done in Qbasic as many here in the echo have found out.„„'If anyone wants to see the QuickBasic version, just ask and„'I'll be glad to post it.  (It's a little faster, and doesn't„'use the SCREEN function)„„DEFINT A-Z„DECLARE SUB shutup ()„DECLARE SUB KeyWait (dly%)„DECLARE SUB FastPrte (Row%, Col%, Buffer$, Attr%, Visible%)„DECLARE SUB PopUp (Row%, Col%, Widthe%, Height%, Attr%, Title$, Bdr%)„DECLARE SUB bPU (R%, c%, W%, H%, Fg%, Bg%, Title$, Bdr)„TYPE ScreenData          'if calling from another prog module„Row AS INTEGER        'use both of these 2 type def, in„Col AS INTEGER        'both calling and called program„Widthe AS INTEGER„Height AS INTEGER„Attr AS INTEGER„END TYPE„TYPE ScreenPram„Char AS STRING * 1„Attr AS STRING * 1„END TYPE„'I have not tried calling this version from another program, but„'it 'should' work just like the Quickbasic version:„„'if called from another program, use the next 4 statements in order,„'in the call-ING program„„'this goes in both programs:„COMMON SHARED SD() AS ScreenData, x() AS ScreenPram, scrnsUP  AS INTEGER„„'next 3 declaractions not needed in the call-ED program„  „boxes% = 12   'this works for me.. if you have mem prob.. reduce this #„'and don't open as many boxes„'demo requires 12.. if you change this # be sure to„'save afterward to avoid out of string space errors.„DIM SHARED SD(boxes%) AS ScreenData„DIM SHARED x(1 TO boxes%, 25, 80)  AS ScreenPram„„SCREEN 0: COLOR 7, 1: CLS„'FOR I = 0 TO 1997 STEP 2:   PRINT CHR$(3); : PRINT " "; : NEXT„FOR I = 0 TO 999 STEP 2:   PRINT CHR$(3); : PRINT " "; : NEXT„COLOR &HE„FOR I = 999 TO 1997 STEP 2:   PRINT CHR$(3); : PRINT " "; : NEXT„„CALL bPU(2, 10, 50, 10, &HE, 4, Title$, 0)„Msg$ = "Show a box with no borders"„LOCATE 6, 22: COLOR &HE, 4: PRINT Msg$;„KeyWait 3„„CALL bPU(4, 15, 50, 10, &H1E, 4, Title$, 2)„Msg$ = " Same box with blinking borders "„LOCATE 8, 25: COLOR &HE, 4: PRINT Msg$;„KeyWait 3„„CALL bPU(6, 20, 50, 10, &HE, 4, Title$, 2)„Msg$ = " Same box with blinking text "„LOCATE 10, 31: COLOR &H1E, 4: PRINT Msg$;„KeyWait 3„„Title$ = "Give it a Title"„CALL bPU(8, 25, 50, 10, &HE, &H9, Title$, 2)„Msg$ = " Change the Color "„LOCATE 12, 42: COLOR &H1E, 4: PRINT Msg$;„KeyWait 3„„Title$ = "[Any title you want]"„KeyWait 3„„Title$ = " Windows for QBasic!! "„CALL bPU(10, 10, 60, 5, &H5, &H7, Title$, 2)„Msg$ = " Watch out Bill Gates!!! "„LOCATE 12, 28: COLOR &H17, 5: PRINT Msg$;„KeyWait 3„„Title$ = "[Full screen display]"„CALL bPU(1, 1, 80, 25, &HE, &H4, Title$, 2)„Msg$ = "As many as 16 boxes displayed at once!"„LOCATE 11, 24: COLOR &H1E, 4: PRINT Msg$;„Msg$ = "      All open at one time!!         "„LOCATE 12, 24: COLOR &H1E, 4: PRINT Msg$;„KeyWait 4„FOR I = 0 TO scrnsUP: shutup: NEXT„„Title$ = "Small Window"„bPU 3, 6, 16, 5, &H6, &H3, Title$, 2„KeyWait 1„bPU 5, 8, 16, 5, &H6, &H0, Title$, 2„bPU 7, 10, 16, 5, &H6, &H1, Title$, 2„bPU 9, 12, 16, 5, &H6, &H2, Title$, 2„bPU 11, 14, 16, 5, &H6, &H3, Title$, 2„bPU 13, 16, 16, 5, &HE, &H4, Title$, 2„KeyWait 3„„Title$ = "Larger Windows"„bPU 2, 30, 26, 10, 6, &H7, Title$, 2„KeyWait 1„bPU 4, 32, 26, 10, &HF, &H8, Title$, 2„bPU 6, 34, 26, 10, &H8, &H1, Title$, 2„bPU 8, 36, 26, 10, 9, &H2, Title$, 2„bPU 10, 38, 26, 10, &HA, &H3, Title$, 2„bPU 12, 40, 26, 10, &HB, &H4, Title$, 2„'bPU 14, 42, 26, 10, &HC, &H5, Title$, 1„'bPU 16, 44, 26, 10, &HD, &H6, Title$, 1„KeyWait 4„FOR I = 0 TO scrnsUP: shutup: NEXT„„Title$ = "Popup just a centered message"„bPU 10, 22, 40, 1, &H4, &H3, Title$, 0„KeyWait dly%„Title$ = "Not bad for a Right Wing Redneck!!"„bPU 12, 22, 40, 1, &H4, &H3, Title$, 0„KeyWait dly%„Title$ = "Go-Pat-Go"„bPU 12, 22, 40, 1, &H4, &H3, Title$, 0„KeyWait dly%„FOR I = 0 TO scrnsUP: shutup: NEXT„„Title$ = "<<<<< WOW >>>>>"„bPU 12, 21, 40, 1, &H7, &H4, Title$, 0   'this is neat.. it uses„Title$ = "It's all in Qbasic"            'the centered title to„bPU 13, 21, 40, 1, &H4, &H3, Title$, 0   'display a one liner„KeyWait dly%„FOR I = 0 TO scrnsUP: shutup: NEXT„„FOR I = 8 TO 14„Title$ = "More exciting features to come!!!"„   bPU (I), 21, 40, 1, &HF, &H3, Title$, 0  'tip, put the i in ()„NEXT                                        'to keep it from getting„                                            'changed in the sub„KeyWait dly%„FOR I = 0 TO scrnsUP: shutup: NEXT   'closes all open boxes„„bPU 8, 9, 64, 12, &HB, &H4, "By: Charles Godard", 2„RESTORE Credits:„„FOR I = 9 TO 18„READ A$:„LOCATE (I), 11: COLOR &H4, 3: PRINT A$„NEXT„END„Credits:„DATA" Thanks to all in the  Qbasic conference for the good ideas "„DATA" The KeyWait SUB is from the discussions on the Delay timer "„DATA" Thanks to  *Gary Godard*  for the suggestions  relating to "„DATA" storing the screendata in a one byte string and for a good "„DATA" explanation of how multiple dimension array's work.        "„DATA"                                                            "„DATA" Alex Wellerstein and Bob Perkins discussions on the SCREEN "„DATA" Function,  opened my eyes  to what it would do and that is "„DATA" what gave me the idea to re-code this to Qbasic.   Since I "„DATA" already had it done in QB, it wasn't a big prob. to recode."„„SUB bPU (R, c, W, H, Fg, Bg, Title$, Bdr)„„scrnsUP = scrnsUP + 1„SD(scrnsUP).Row = R„SD(scrnsUP).Col = c„SD(scrnsUP).Widthe = W„SD(scrnsUP).Height = H„SD(scrnsUP).Attr = SCREEN(R + 1, c + 1, 1)„„'store the screen„FOR Row = R TO R + H - 1„ FOR Col = c TO c + W - 1„ x(scrnsUP, Row, Col).Attr = CHR$(SCREEN(Row, Col, 1))„ x(scrnsUP, Row, Col).Char = CHR$(SCREEN(Row, Col))„ NEXT Col„NEXT Row„„'put a box on the screen„FOR Row = R TO R + H - 1„COLOR Fg, Bg„LOCATE Row, c: PRINT STRING$(W, " ");„NEXT Row„„'set up border styles„SELECT CASE Bdr„CASE IS = 1„bdrtl = 218: bdrtr = 191: bdrlc = 192: bdrrc = 217: 'corners„bdrv = 179: bdrh = 196:          'horizontal, vertical sides„CASE IS = 2„bdrtl = 201: bdrtr = 187: bdrlc = 200: bdrrc = 188: 'corners„bdrv = 186: bdrh = 205:          'horizontal, vertical sides„END SELECT„„'? the corners to the box„COLOR Fg, Bg: LOCATE R, c: PRINT CHR$(bdrtl);„COLOR Fg, Bg: LOCATE R, c + W - 1: PRINT CHR$(bdrtr);„COLOR Fg, Bg: LOCATE R + H - 1, c: PRINT CHR$(bdrlc);„COLOR Fg, Bg: LOCATE R + H - 1, c + W - 1: PRINT CHR$(bdrrc);„„'put the border sides around the box„'Lt side bdr„FOR Row = R + 1 TO R + H - 2„COLOR Fg, Bg„LOCATE Row, c„PRINT CHR$(bdrv);„NEXT Row„'Rt side bdr„FOR Row = R + 1 TO R + H - 2„COLOR Fg, Bg„LOCATE Row, c + W - 1„PRINT CHR$(bdrv);„NEXT Row„'top bdr„COLOR Fg, Bg„LOCATE R, c + 1„PRINT STRING$(W - 2, CHR$(bdrh));„'bottom bdr„COLOR Fg, Bg„LOCATE R + H - 1, c + 1„PRINT STRING$(W - 2, CHR$(bdrh));„ Center = c + (W - LEN(Title$)) \ 2„ LOCATE R, Center: PRINT Title$;„END SUB„„SUB KeyWait (dly%)„„IF dly% = 0 THEN dly% = 3„T& = TIMER„DO UNTIL ABS(TIMER - T&) > dly OR LEN(INKEY$): LOOP„END SUB„„SUB shutup„IF scrnsUP < 1 THEN EXIT SUB„R = SD(scrnsUP).Row„c = SD(scrnsUP).Col„W = SD(scrnsUP).Widthe„H = SD(scrnsUP).Height„A = SD(scrnsUP).Attr„„COLOR Fg, Bg„FOR Row = R TO R + H - 1„ FOR Col = c TO c + W - 1„ LOCATE Row, Col„ A = ASC(x(scrnsUP, Row, Col).Attr)„ Fg = A AND &HF„ Bg = (A \ &H10)„ COLOR Fg, Bg„ PRINT x(scrnsUP, Row, Col).Char;„ NEXT Col„NEXT Row„scrnsUP = scrnsUP - 1      'tracks the last open box which is still open„„END SUB„Bradley Miller                 PB WINDOWS LIBRARY             bgmiller@midwest.net           08-02-96 (20:48)       PB                     308  8868     WINLIB.BAS  ' These routines are aimed at hopefully helping those that are new to„' writing code in the PowerBASIC enviroment. (like me)„' There's not much here but if it can be of some help, I'm happy.„' If you don't need them because you are good at this kind of stuff,„' help someone who is striving to learn. (like me)„' Anyway, use 'em or lose 'em.„'„' If you have comments or suggestions please make contact...„'   Internet: bgmiller@midwest.net„' or„'   B. G. Miller„'   P. O. Box 184„'   Ullin, IL. 62992„'---------------------------------------------------------------------------„„DECLARE SUB center(lcol%, rcol%, text$, row%)„DECLARE SUB cover(trow%, brow%, lcol%, rcol%, cnum%)„DECLARE SUB putwin(trow%, brow%, lcol%, rcol%, shad%, text$, fg%, bg%)„DECLARE SUB putbox(trow%, brow%, lcol%, rcol%, bord%, shad%, text$)„DECLARE SUB lilshad (trow%, brow%, lcol%, rcol%)„DECLARE SUB putscrn(scrn$)„DECLARE FUNCTION vidseg&()„DECLARE FUNCTION getscrn$()„DECLARE SUB hold()„„DIM lastscrn$(4)             ' make array for screens„„COLOR 9, 0„CLS„cover 2, 24, 1, 80, 176           ' cover background with chr$(176)„COLOR 0, 7„LOCATE 1, 1: PRINT STRING$(80, 0);„LOCATE 25, 1: PRINT STRING$(80, 0);„center 1, 80, "Press any key to continue...", 25„lastscrn$(0) = getscrn$„hold„„COLOR 15, 7„ putbox 3, 9, 6, 38, 2, 1, ""„ lastscrn$(1) = getscrn$„ hold„COLOR 7, 1„ putbox 13, 19, 4, 72, 4, 1, " Description "„ lastscrn$(2) = getscrn$„ hold„COLOR 15, 5„ putbox 4, 21, 44, 75, 1, 2, " Description "„ lastscrn$(3) = getscrn$„ hold„COLOR 14, 6„ putbox 3, 21, 3, 77, 4, 2, ""„ cover 4, 20, 4, 76, 247       ' put some junk in box„ lastscrn$(4) = getscrn$„ hold„COLOR 11, 3„ putbox 6, 17, 12, 51, 5, 2, ""„ hold„ putscrn lastscrn$(4)„ hold„ putscrn lastscrn$(3)„ hold„ putscrn lastscrn$(2)„ hold„ putscrn lastscrn$(1)„ hold„ putscrn lastscrn$(0)„ hold„COLOR 0, 7„ putbox 3, 22, 3, 77, 6, 2, ""„ hold„COLOR 14, 3„ putbox 5, 12, 5, 21, 1, 0, ""„COLOR 0, 7„ lilshad 5, 12, 5, 21„ hold„COLOR 11, 1„ putbox 4, 13, 26, 66, 2, 0, ""„COLOR 0, 7„ lilshad 4, 13, 26, 66„ hold„COLOR 15, 4„LOCATE 21, 6: PRINT " Button 1 "„COLOR 14, 3„LOCATE 21, 21: PRINT " Button 2 "„COLOR 11, 1„LOCATE 21, 36: PRINT " Button 3 "„COLOR 14, 5„LOCATE 21, 51: PRINT " Button 4 "„COLOR 0, 7„ lilshad 21, 21, 6, 15„ lilshad 21, 21, 21, 30„COLOR 8, 7„ lilshad 21, 21, 36, 45„ lilshad 21, 21, 51, 60„hold„COLOR 15, 0„ putbox 16, 18, 4, 68, 2, 0, " Description "„COLOR 8, 7„ lilshad 16, 18, 4, 68„ hold„ putscrn lastscrn$(0)„ hold„COLOR 1, 7„ putwin 3, 22, 3, 77, 1, "This is the top text", 7, 1„COLOR 1, 7„ center 3, 77, " This is the bottom text...", 22„ hold„COLOR 15, 1„ cover 4, 21, 4, 76, 88    ' put some junk in box„ hold„COLOR 7, 4„ putwin 6, 18, 7, 60, 1, "", 4, 7„ hold„ putscrn lastscrn$(0)„ hold„COLOR 0, 7„ putwin 6, 18, 7, 70, 1, "", 7, 0„COLOR 15, 0„ center 7, 70, "That's all.......", 12„ hold„COLOR 7, 0„CLS„END„„'---------------------------------------------------------------------------„SUB center (lcol%, rcol%, text$, row%)„„cols% = (rcol% - lcol%) + 1     ' # of columns to center text in„cdif% = cols% - LEN(text$)      ' difference in text length and col%„mcol% = (cdif% \ 2) + lcol%     ' column to start at„LOCATE row%, mcol%„PRINT text$;„„END SUB„'---------------------------------------------------------------------------„SUB cover(trow%, brow%, lcol%, rcol%, cnum%)„„numcols% = (rcol% - lcol%) + 1      ' # of columns to cover„„FOR x% = trow% TO brow%             ' for loop covers form toprow to„ LOCATE x%, lcol%                  ' bottomrow, numcol% wide with„ PRINT STRING$(numcols%, cnum%);   ' character(chr$) number (cnum%)„NEXT x%„„END SUB„'---------------------------------------------------------------------------„SUB lilshad (trow%, brow%, lcol%, rcol%)„„IF trow% = brow% THEN GOTO oneline„„numcol% = (rcol% - lcol%) + 1„LOCATE brow% + 1, lcol% + 1: PRINT STRING$(numcol%, 223);„LOCATE trow%, rcol% + 1: PRINT CHR$(220);„„FOR x% = trow% + 1 TO brow%„ LOCATE x%, rcol% + 1„ PRINT CHR$(219);„NEXT x%„EXIT SUB„„oneline:           ' if just 1 row„„numcol% = (rcol% - lcol%) + 1„LOCATE brow% + 1, lcol% + 1: PRINT STRING$(numcol%, 223);„LOCATE trow%, rcol% + 1: PRINT CHR$(220);„„END SUB„'---------------------------------------------------------------------------„SUB putwin(trow%, brow%, lcol%, rcol%, shad%, text$, fg%, bg%)„„' putwin calls putbox to make initial box„putbox trow%, brow%, lcol%, rcol%, 6, shad%, text$ ' border here must be 6„color fg%, bg%       ' must be reverse of original color for putwin„numcols% = (rcol% - lcol%) + 1        ' # of columns to cover„„FOR x% = trow% + 1 TO brow% - 1       ' leave border top and bottom„ LOCATE x%, lcol%„ PRINT STRING$(numcols%, 0);          ' print nothing to cover (0)„NEXT x%„„FOR x% = trow% + 1 TO brow% - 1„ LOCATE x%, lcol%: PRINT CHR$(221)    ' left border„ LOCATE x%, rcol%: PRINT CHR$(222)    ' right border„NEXT x%„„END SUB„'---------------------------------------------------------------------------„SUB putbox(trow%, brow%, lcol%, rcol%, bord%, shad%, text$)„„ SELECT CASE bord%„  CASE 1  ' single line border„   tlc$ = CHR$(218): tm$ = CHR$(196): trc$ = CHR$(191): s$ = CHR$(179)„   blc$ = CHR$(192): bm$ = CHR$(196): brc$ = CHR$(217)„  CASE 2  ' double line border„   tlc$ = CHR$(201): tm$ = CHR$(205): trc$ = CHR$(187): s$ = CHR$(186)„   blc$ = CHR$(200): bm$ = CHR$(205): brc$ = CHR$(188)„  CASE 3  ' double line top, single line side„   tlc$ = CHR$(213): tm$ = CHR$(205): trc$ = CHR$(184): s$ = CHR$(179)„   blc$ = CHR$(212): bm$ = CHR$(205): brc$ = CHR$(190)„  CASE 4  ' single line top, double line side„   tlc$ = CHR$(214): tm$ = CHR$(196): trc$ = CHR$(183): s$ = CHR$(186)„   blc$ = CHR$(211): bm$ = CHR$(196): brc$ = CHR$(189)„  CASE 5  ' thick line all sides„   tlc$ = CHR$(219): tm$ = CHR$(223): trc$ = CHR$(219): s$ = CHR$(219)„   blc$ = CHR$(219): bm$ = CHR$(220): brc$ = CHR$(219)„  CASE 6  ' no lines„   tlc$ = CHR$(0): tm$ = CHR$(0): trc$ = CHR$(0): s$ = CHR$(0)„   blc$ = CHR$(0): bm$ = CHR$(0): brc$ = CHR$(0)„  CASE ELSE  ' single line if < 1 or > 6„   tlc$ = CHR$(218): tm$ = CHR$(196): trc$ = CHR$(191): s$ = CHR$(179)„   blc$ = CHR$(192): bm$ = CHR$(196): brc$ = CHR$(217)„END SELECT„„wide% = (rcol% - lcol%) - 1„„IF text$ > "" THEN         ' text$ is title if wanted„ widedif% = wide% - LEN(text$)„ rwide% = widedif% - 3     ' put title 3 columns right of top-left corner„ LOCATE trow%, lcol%„ PRINT tlc$; STRING$(3, tm$); text$; STRING$(rwide%, tm$); trc$  ' top with title„ELSE„ LOCATE trow%, lcol%„ PRINT tlc$; STRING$(wide%, tm$); trc$;   ' top with no title„END IF„„FOR I% = trow% + 1 TO brow% - 1           ' for loop prints middle„ LOCATE I%, lcol%„ PRINT s$; SPACE$(wide%); s$;„NEXT I%„„LOCATE brow%, lcol%„PRINT blc$; STRING$(wide%, bm$); brc$;    ' print bottom„„IF shad% = 0 THEN EXIT SUB     ' if no shadow wanted (0) exit sub„„' put shadow right side and bottom of box„„video& = vidseg&              ' call vidseg& function„IF video& =  &hb000 THEN„ EXIT SUB                     ' monochrome, no need for shadow„ELSE„ DEF SEG = &hb800„END IF„„' get present screen attributes„attr% = SCREEN(brow% + 1, rcol% + 1, -1)  ' get attribute„attr% = attr% AND 15                      ' get forground„attr% = attr% - 8                         ' dim if bright„IF attr% < 1 THEN attr% = 8               ' if wasn't bright„' if don't want dim, 15 to 7 or 9 to 1, use 8 for attr%„„' POKE shadow where needed...POKE right side„„FOR row% = trow% + 1 TO brow% + 1       ' 1 less than top, 1 greater than bottom„ FOR col% = rcol% + 1 TO rcol% + shad%  ' shad% is # columns, 1 or 2 usually„  offset% = (row% - 1) * 160 + (col% - 1) * 2 + 1„  POKE offset%, attr%„ NEXT„NEXT„' POKE bottom„row% = brow% + 1                        '1 row past bottom„„FOR col% = lcol% + shad% TO rcol% + shad%   ' shad% is 1 or 2„ offset% = (row% - 1) * 160 + (col% - 1) * 2 + 1„ POKE offset%, attr%„NEXT„„DEF SEG„„END SUB„'---------------------------------------------------------------------------„SUB putscrn(scrn$)„„def seg = vidseg&„poke$ 0, scrn$„def seg„„END SUB„'---------------------------------------------------------------------------„FUNCTION getscrn$()„„def seg = vidseg&„getscrn$ = peek$(0, 4000)    ' 1 screen color„def seg„„END FUNCTION„„'---------------------------------------------------------------------------„FUNCTION vidseg&()„„DEF SEG = 0„IF PEEK(&h463) = &hb4 THEN„ vidseg& = &hb000„ELSE„ vidseg& = &hb800„END IF„DEF SEG„„END FUNCTION„'---------------------------------------------------------------------------„SUB hold()„„WHILE NOT INSTAT„LOOP„DO„LOOP UNTIL INKEY$ = ""„„END SUB„Charles Godard                 PICK LIST DEMO                 FidoNet QUIK_BAS Echo          10-13-96 (12:20)       QB, PDS                182  5336     PICKLIST.BAS' >Anyone out there have any code examples for a pick list box ? Mouse support„' >would be a welcome addtion :)„'„'Here is one I've been working on, off and on.  It's not polished„'and I haven't started programming with the mouse yet, but maybe„'you can polish it up and use it.„'                              Picklist.bas„'                           By Charles Godard„'                               10/12/96„DEFINT A-Z„'$INCLUDE: 'qb.bi'   'give it a path to qb.bi„DIM SHARED Inreg AS regtypex, outreg AS regtypex„ TYPE BoxType„  Char AS STRING * 1„  Attr AS STRING * 1„ END TYPE„ TYPE boxParameters„  scrn AS INTEGER„  Tr AS INTEGER„  Br AS INTEGER„  Lc AS INTEGER„  Rc AS INTEGER„ END TYPE„COMMON SHARED Box() AS BoxType, bp AS boxParameters„'***Duplicate the common shared and TYPE def when calling from another***„'***program module.  Exact duplicates are advised! ...................***„SCREEN 0„CLS„COLOR &H7, &H9: FOR i = 0 TO 999: PRINT CHR$(3); " "; : NEXT„DIM Item(8)  AS STRING   'dim to only as many items„Item(0) = "  Zero   "     'as you will use in list„Item(1) = "  One    "„Item(2) = "  Two    ": Item(3) = "  Three  "„Item(4) = "  Four   ": Item(5) = "  Five   "„Item(6) = "  Six    ": Item(7) = "  Seven  "„Item(8) = "  Eight  "„Selected% = Picklist(10, 35, 8, 3, Item())„COLOR &H1E„LOCATE 12, 31: PRINT "You selected Item: "; Selected%„COLOR &HE„SLEEP„„SUB ClosePicklist„	 scrn = bp.scrn„	 Tr = bp.Tr„	 Br = bp.Br„	 Lc = bp.Lc„	 Rc = bp.Rc„ FOR x = Tr TO Br„ FOR y = Lc TO Rc„  LOCATE x, y:„  fg = ASC(Box(x, y).Attr) AND &HF„  bg = (ASC(Box(x, y).Attr) \ &H10)„  COLOR fg, bg„  PRINT Box(x, y).Char„ NEXT y, x„scrn = scrn - 1„END SUB„„'Waits for a sinlge keystroke and returns the function keys as a„'minus number„FUNCTION GetKey%„	 Inreg.ax = &H0„	 INTERRUPTX &H16, Inreg, outreg„ LoVal% = outreg.ax AND &HFF  'returns Lo byte as ascii keys + #„		  'hi-byte as - # (function keys)„ IF LoVal% = 0 THEN„  GetKey% = -(outreg.ax AND &HFF00) \ &H100„ ELSE„  GetKey% = outreg.ax AND &HFF„ END IF„END FUNCTION„„FUNCTION Picklist% (Tr%, Lc%, W%, H%, Item() AS STRING)„Lines = UBOUND(Item)„IF H > Lines THEN H = Lines„Br = Tr + H: Rc = Lc + W„QBasicPU Tr, Br, Lc, Rc, &H34, "Choose"„offset = 1:„Scroll 0, Tr - 1, Br - 1, Lc - 1, Rc - 1, &H17, Br - Tr + 1„ FOR Ct = 0 TO H„  IF Ct < Br - Tr + 1 THEN   'scrolls up„   Scroll 0, Tr - 1, Br - 1, Lc - 1, Rc - 1, &H17, 1„   LOCATE Br, Lc„   COLOR &H7, 4„   PRINT Item(E%);„  END IF„  E% = E% + 1„ NEXT„   'hi-lite the 1st line„   Ct = 0  'reset it for reuse„   LOCATE Tr, Lc: COLOR &HF, 4„   PRINT MID$(Item(Ct), offset, W%)„   IF bxRow < Tr THEN bxRow = Tr„„DO„   KeyP% = GetKey%„   SELECT CASE KeyP%„	 CASE IS = 13, 32„	    Selected% = Ct„	    LOCATE 10, 1„	    'PRINT Selected%„	    Picklist = Selected%„	    ClosePicklist„	    EXIT FUNCTION„	 CASE IS = -80 'arrow Dn     SCROLL THE COMMANDS„	    Ct = Ct + 1  'keeps track of the element„	    IF Ct > Lines THEN   ' limits # of variables to # of„		  Ct = Lines     ' lines in file.„	    ELSE„		  IF bxRow < Tr THEN bxRow = Tr  'sets top limit of„		  bxRow = bxRow + 1               'where scroll begins„		  'scrolls PRINTING down the 1st page„		  IF bxRow < Br + 1 THEN„			LOCATE bxRow, Lc: COLOR &HF, 4„			PRINT MID$(Item(Ct), offset, W%)„			LOCATE bxRow - 1, Lc: COLOR &H7, 4„			PRINT MID$(Item(Ct - 1), offset, W%)„		  ELSE„			'scrolls SCREEN UP prints to Bottom line on the 2nd page„			'colors the last line„			LOCATE Br, Lc: COLOR 7, 4„			PRINT MID$(Item(Ct - 1), offset, W%)„			Scroll 0, Tr - 1, Br - 1, Lc - 1, Rc - 1, &H17, 1„			LOCATE Br, Lc: COLOR &HF, 4„			PRINT MID$(Item(Ct), offset, W% + 1)„			IF bxRow > Br THEN bxRow = Br„		  END IF„	    END IF„	 CASE IS = -72       'arrrow Up   „	    'scrolls SCREEN DN prints to the top line of 1st page„	    IF (bxRow <= Tr) AND Ct >= 1 THEN„		  bxRow = bxRow - 1: Ct = Ct - 1„		  LOCATE Tr, Lc: COLOR &H7, 4„		  PRINT MID$(Item(Ct + 1), offset, W%)„		  Scroll 1, Tr - 1, Br - 1, Lc - 1, Rc - 1, &H17, 1„		  LOCATE Tr, Lc: COLOR &HF, 4„		  PRINT MID$(Item(Ct), offset, W% + 1)„	    ELSE„		  'scrolls PRINTING UP the page when not on 1st line„		  IF Ct >= 1 THEN„			bxRow = bxRow - 1: Ct = Ct - 1„			LOCATE bxRow, Lc: COLOR &HF, 4„			PRINT MID$(Item(Ct), offset, W%)„			LOCATE bxRow + 1, Lc: COLOR &H7, 4„			PRINT MID$(Item(Ct + 1), offset, W%)„		  END IF„	    END IF„   END SELECT„LOOP UNTIL KeyP% = 27„ClosePicklist„END FUNCTION„„SUB QBasicPU (Tr%, Br%, Lc%, Rc%, Attr%, Title$)„ bp.scrn = bp.scrn + 1„ bp.Tr = Tr„ bp.Br = Br„ bp.Lc = Lc„ bp.Rc = Rc„REDIM Box(Br, Rc)  AS BoxType„ FOR x = Tr TO Br„ FOR y = Lc TO Rc„  Box(x, y).Attr = CHR$(SCREEN(x, y, 1))„  Box(x, y).Char = CHR$(SCREEN(x, y))„ NEXT y, x„ bg = Attr AND &HF: fg = Attr \ &H10„ COLOR fg, bg„ FOR x = Tr TO Br„  LOCATE x, Lc, 0„  PRINT STRING$(Rc - Lc, CHR$(32))„ NEXT x„END SUB„„SUB Scroll (dir%, upperRow, lowerRow, leftCol, rightCol, Attr%, Lines%)„IF dir% = 0 THEN dir% = &H6 ELSE dir% = &H7„'6 is up   :      7 is down„ Inreg.ax = (dir% * &H100) + Lines%„ Inreg.bx = Attr% * &H100„ Inreg.cx = (upperRow * &H100) + leftCol„ Inreg.dx = (lowerRow * &H100) + rightCol„ INTERRUPTX &H10, Inreg, outreg   'no return„END SUB„