David Rice                     IPX ROUTINES                   www.globalserve.net/~brent/tech12-13-96 (22:00)       QB, PDS                381  25229    IPX.BAS     DEFINT A-Z:DIM SHARED K,S,B&,Z&:V1 'Created by PostIt! 7.2„SUB V1:OPEN "O",1,"IPX.ZIP",4^6:Z&=18677:?STRING$(50,177);„U"%up()%9%%%7-%3MJ]FxX)==I+%%%i>%%%,%%%%nu&'SgfOxN'<)Bjk5cwg>xDV\„U"LXJtkD4L\E.uErO)')i$J48_if\)Q%;HF)c&ErV.XT:$_Y]83Lnq_v[,ZMLH=>i„U"pE>hOs8NPu$mqaU9-YHLnkfiQPj$86R\x,l?pNI3p?1]+;1D,iY/SjhnHg'eUnk„U"*^IQs0aSZK:F?,ngA5=\g'<Mnv[oelw97vnV>-Uswh1g;/(65]q4;qu,Q\q2YYE„U"]Xxa_,R?^/94UZEHkcIc)4iG>7EBOUD([I0:0Ks$8jRd?>C?q#UeWJ^y$:EE=C\„U"N>Q0iXg$_#bYRh;lO(J9l82Pk[h7lq$P]sXQFJUM1A/sq9*N_+:P+]6sg#=AYNm„U";/ql9=E.U2a]$?O$9o][i:HF;Kb_u.Z9Bw]BIc\R9UJ<95n48/gIq>o\&k_7zYa„U"rBvqSSI041AvhDsjU#.-ihia%C%TFT(e$b9HgxpqS)t1_Wf1;NQ6^Y)waXK+S<=„U"F/*FgX#<i%(l7FOZFB&he\m.Bh*p*0Ac5lC0[]dc[ki?kma2'Xn<%:D63=P]]]M„U"6r&ls&Ua;]Dc_\qbV'NVUsz,$-?i):9'rikxaK3YJzU+*wlSc-gVG8oqhfJc):?„U"CXe,(?G)[mS:]Q$/TbbU8-<rVA*Sz:^P+<h2iB#O5yf+w4z2qQ798ZQrPB?Lb:q„U"3Gk4YaF_eapHkt]g_X#I1FSK$xk?).42JsG&j\'W?e?7?Rfn-m>FqU*T-T$o?f<„U"rF<IK$S=Utm,1_q;h/*GCLLe4#w\,X;<:G*lHgvh?D0_9e6s053KjPO1OxCJg?/„U"[ch+:a)+(SKnL1]Y_cc_'_X8[>W%ptMcHNipb9#RoST?pqqWLGS8$*0:kh1S%nA„U"J+bb6wZlm\Opk*vd7<EZ1$^^G=m*]=*'xMfe'ZM<t,<H/B>:h;:]fgIHU%C[C$G„U"arVAX&O$WABD9#dVWH2%tImbM#mZ*ysB=&On_Cv$>wMs]'*Hpl5(=JUKDXT%BLM„U"\<R7uV+L6jG)&hCy[HO<-KnoGhBbc3x23,]^3K-dqU>#lH+,BquQAJnUW-I(5q#„U"Gmrhk(?3+ZXi_lN0rn[DmcRLiLd#\i\f5uKDsu=?gTJTU:a^ATKL<#-&ds^7qz>„U"Bspw&$sMu$FnS0gf]^uJ?D($Utj)Fq?r_S3/&7ecy33$YH]3:=&sA:PvWs['TVk„U"/<]';fts09#(x-:[trkd1Al5j1%Nq0?k=hi%/Z)55;zjl[bA8H2/:J(&vLm&\T3„U"(%<UXJvilxPr4mD04DM4KkoSH0K^H$L_PF?dX[.h<NI9H>JJf[iNSv>Bh$=]GkP„U"BPIz:k)PB(L1(gF\\:Cl*RhL'KK/>>xW[#3Y\indMNQ+Gx+?.&jbuhRd4A9)JJ8„U"tphmf2X2WOqc6mg'7FShXd(<8V6k2B/YfQPwEq]SLM)jqD0I[B(bkjfPyX(r'As„U"l2W)'.5uX>>?Z;OkW#gM2#w0n$JP8P<BTG0:CKWQqekxxv6O.x$beObvulP&(g7„U"W:gY;P&ui/r6VJV:m9QP^Na(TU$9gM64\-XVD76agoO:GWFyZs/dSQs]zjoo0f[„U"-MS.HF3(elPLt'j6kYJOWXdk*B1Vq1+m>M2tXVLh(hi,&GubW^6S>;#a7gnipHU„U"w[3jOo*2xCFk't(BqU]?MW=p\kn;esCzXz4DZMi3KJZPmUZ5xs_dNw>ao]2OQ?#„U"7+&&:tNNjQ(XvFhY#u\0ShI,V1:>Tk%;sp3?^e.cTY'/'wSHyUnZW#U'$1&hsIg„U"#U0[;JD3'Y__yYrh,dH;4dch's/0I]8\9yPPqd9eW?0#G^75$$Ph2vG6_aWt2hm„U"0OU:*I$cuLvKb)_?tSkr]pV/djYcBqN)CV](aFQUC,03fy_OUxTn0fH)R<rIMRh„U"bFZ,1Q159=bU3pDq%GGK$:F49*/,o[VJ1cU^,^>cs#[+p-u]l^97OKq$fMn6=,$„U"t+A'A0SN;>?MSx[h9V2KKvheI3Fp.c-3UtClthq%4XjIh)d/YXERZ.c2N%%up(%„U")9%%%%-%0^N]FdU6O0N#-%%]%C%%-%%%%n(u'xS[gfxFg>:BT?1j,X>bx)v2l'9„U":[zsB0*Fl_hUpc>XFq2IlOxs\pCEZHY=ur)t?vn>'IE._ciGFfbqc2d*,>e00Za„U"[vFeGS-8o3%n*WgfYa\G*+t\Fme;.L'01ZxE</qJ21O+='+h&wd2^NSBBO,Xx9W„U"_P0eYiMRA7lP3-8qig\2<ZgYc?U).i4IwFCDujV\$,SkI-fb9SF2/Ij_V8k[^+A„U"AJ\c-/aYYp0DYM_/Je.u[bJ=D$[k[bY5*fR:d_s3?rh^Dm>Gm=Zx)L?XdoDxu9p„U"FE7tIk7V3/H7bz\,'0Q2ln;n^',PG=mk]lMDa*afVB[N.OF8/6V4RrN+6i;?Ht9„U"c7X(>,L&k$nIp]M%[irDeE*6R;G?pvgfvibNkk7T'T0Fq(OzSskbT8eBVe0>8B_„U"l6*Yq_var=2dp[M?*V^TM7s]XGGe;j)/,l?tNj2ozH]'Wu;['A[)w6Z^g$#8W/H„U"Ro+idr_?pYGI)4R4RIgMZuR?6Bm9M2gt/nI?#=Xf8gWGUDMK(2n5QQm,X)\K#TJ„U")m:\0)v.imt,;u4$Df1o=\DG0XlFWiHG=\tACU+m4\7JqA_,[>7KI0<G[2bKnf%„U"gCVzebyWml7WjYn_lh)sLDP(EG[JAp#[<oWE*L0DojK7BU)r)+=h#E*P9W[XfL2„U"#ldOwU:+dR%Gho)?RfL4Y]wYm6[20:t4hHht4IGoM3ujW^aCUQBARQtWK[dBKLx„U"Qh0olUWCr3(%Pc3J/G:J^n*7^/TV=A+b]fWKsrO1ZI]>4X;D'Z7Hj;FJeK&<]qI„U"a$Xf<u,OvkgLi;V/LEg=?DU=E[It?5F9o&hJE$503LY:1G7[d]P8Gk(&^YhUH'>„U"_<#lY<Z7-\u4R^6tb4V>lo?/T/ujWm[qgPaohR[IQu0;fI5Onug<>ob1G=zS5R2„U"c1lZJ#8a5F[B?K8&*'J,QP7LiTPUt39rjLi#3AU16hWh_hDACPkqhNYZf%UNtGD„U",eZ%F_CY^G5eQq+?6H7/'c.SyQWL1LxKQO\]74E7WqOKDP?d+LrK%$?6)U2sU<A„U"q69?:g\l.l(815'YWzj06^X\k_yPd8$q?SZ+TVUjmN/m?l*$RGfVJ8;2Oy6Tj/)„U"Ohi5ut\b^Yk=O0aN:G#V9RCL1i;QCI0:K1tSSX&x0gof(*hfg.llGoEDLugQP3O„U"^/P=S,SKm/)h]nH=Htklg)AOP>.%l:.d_a#cht-nZV>;Qt)\TvP+HolMR&'q=O^„U"H5o>hH\kL>8BsRbpwOifL1ukpvGDFZlg,DgS6v;8wWlJuoVe(;&d>j3c^oX%Hvi„U"VT^7ku3<LUNUUwnL-g2_'g#)TIC$M#+\vT_o%m3&7gQ*>LdJ7..&.A?Sp:we64H„U"q1]EpmxS+z>00F=WZ>U#GWX<.[9Vr>gH.?bjP4M^Tc9<Id*O??UoN;f#C_I5yno„U"ilR3qR&_)WbZZn)L.CZk=wEV&&Y.]9iK])V3OkGlu;O-$\tUMcSz=6he8nuGrXK„U"JN&Xe$5OM$P-Rr/Vz:gsf*[TEX0_L5SH^Z$bm\Y:(GR4M0q#wz.H%4]+U-#kJv$„U"3TdYI(&nYT+UQu6UPYN9iCm*-/3Mtd7Ka&$<6w[F(q$m_xC2\]t,+SlBfH+]92;„U"v0L]b:7X5S0RHUU#,&M*'TR'_Z]>baQAmZ,dP=Q5^prnZRd4X'L[)'?(W<3$6(F„U"\,j8p$#/J,hwTBdANCs:'L0X;3L)?AG*g_EI_7G-A?-CT3lcIE4Kh1tA9o^nk21„U"5j%ZB=iuU#E?^rN8DoG>;Bv:g$thA9&ranoQed&v1h1sdOh*x4syc\C5K&yif^M„U"6j\UIR+$nq9RDtckd4lGo=VqJfXN_cXEnU#-v6RuI3+dw(_FB7^R-2-aem*LlIf„U".nEG97z$zLCXPkE\ImPG\l=X6)H4Sd]kQWmv't+[3v780)rCu#xeeEOnJ1#/82Q„U"g2v'%B%RgN-&?rJC^\13_TdO/4Sh%CLqZAV;<UAuSE_[t8_RjJlrS4rNq'Y9A3(„U"btwDYq0d+lcJ3./k.qkJ>SP^8R;LV*wxlKPNyh3h5NT1&u*:2DpqG5F&yJkwQf&„U"ZY%+a8XNq,DAY<GDha:a#&ysMWjq^2OJ-&Y_7tgJmrd+),^v]Esvf3%W_rd%s4Z„U"/I$gl'lXgHM)qTI0N#:y(2Sx#XM28t6AA9#3*HFqU<jV<gdoCZVQ\\]&G_Qq:NI„U"s4f/WG,,#/u55<KoO]>B4Wyl6w0f$o)5:1UojT1]f+#+]CH'VU.XuRMVRUq_eJr„U":laoKu&nKf^YFu;M[v2K.Z^w/:q,D:<uhR9G,Scx>*O5x:9J.WMY-Y8I02Ok;'K„U"=wSE8UTn9Z5Kad-mi'cla=JJC/cH+2uMFQwc?c'EQSzsX5x>'\V8?7ZGI[_)y<>„U"6fGdrZRq&*0<pN'suNv^oxa.n$1jn;-#<:nddZ2=pG\0WjIGi10b=.(ZWjj/cO9„U"tiGD$l:>ieAoC3DRCsK7?>1)X,Q)^&I/8nm;4/]2UNW7=u3-neL)$OM=jitlIeE„U"-$x\?IN*-[^lH]cug-vDi0zZJ_wevi<cWDc./u5%MyGepehXP^6Lc_qG('H_MYl„U"Es9^.f,tCtjBSTj6CO1ypE9/g?#dA3Jri6qiuj32RQ.v1D[i]h-4.hl5YIepwpX„U"^eod])DiVy=3?6Y__607nJ0SMULw?H7qvssWA9iW(bls/X$%YL1e#Co:/aoql1u„U"D'+=mnd/>t_noXe$)&cPU0IG\#8gPH/Ru-QtmR_K-<ny0\dqr('u<up%()9%%%%„U"-%.AN]F=)RPK%.-%%'?A%%%-%%%.nu'w%SgfxKF>:B9SmkXl'kNa#us1FgQZL/i„U"h=FR.OFSv%*0Dw:7AX9(VO/Fr*IQDQvsjm#>nXaq?kVM*Nx7Q>uXVboVb<^s4XZ„U"27ad4)BrVDf2/b?*=?v8E4Cjn-9qFuP?l6VmB,rB=0s(wc7ZcCXX_;QL]kNhXXH„U"iKRPK7f,3$62h)n80(]e4H)^H>lK2hnsI/Ss&*0cfc5\]&Bw*p<**YlkaA71bSD„U"('a7b;)$0b+U<4.Sh)gu#oXd_?);.,PEcu(eQT;>6Co.m05E8;_V3z^S?tKVkr/„U")>dInolb?-msXA>4Z4CIFOtl8i>XNr6'i#FXN3]Rt$c_U'tX5qbvUM-Fql0I#/O„U")X4pkDExxR:ql#_8UncR+&N.h#<P[4u\k-;dQGl=\oVT=&ZsraqD&fVVN,GKBNs„U">%H?8m]0)7g3;_H/TK-+SQmZBcc:<,TqPRhf.E/XiMn=,Y[DfiBn2]=JpKEpY:L„U"cK4C\>ev*CQ:bj6sVkdp-P$6&h<JR;ga$=oR4lUKabw'HROx^iD-hYu0mpTDX45„U"r;g%vD_jUm3T/UNYX\e_#gq[gVV#;((_nD2M'_\Bpa_^r/(p*G'.kNQ-#1\;DC8„U"y.cKdp\s+;#S;a<O.KdpbhhE>&)0e?ev8*W%V&ofT;bSCx<GD/Y%omD3G/GG0/J„U"I9u#F99MoAm,$\RXTF1mG^IIal>WN5;_V$r*#_d<.y.)Q,Bu9'JgG$%*hW:3?YO„U"uJn';6q0)pi=<1;uajt(OAYK=5VadfpW_)l#KrNYF?o:\iMc35/F9[L4N6/E\ai„U"tbN?)'>B.kYE\DIcv6&%hr&;c97sJi&D2p6/tx[FT)xN>g1f=6>-N&c9aJrgY=a„U"T4RjE1.F_?di7=KFRMBfevob0T2uU75DQgI8xjK?BVr3:PWYlOhXIo9i'(C,'q9„U"t+F$:80-A,/h_mf[rIRHp&d5;hZ,ugb;o3/Jf=2+5a=27'iJ]*0a#*&z,.Ia4E0„U"SqrR]2B2/*5c8wDT3hV#P2B.?+n3M;$2l&<ex/U$?gA5aS^nKl<PT+Js5/01ew+„U"E5Iq<vS,z^S^0-#kQCURH;e%O95Y5(HjgNJMg+Bq-7o=;%Mkx008)S)2o/N1(KH„U"D?fASv/MP]S>2uj*?Ukh_S*Rh(sddOl(O4&1LpVO)XioOzu5[c2jH48D4V0:CGJ„U"*&YoWqS^S[3J(CU^],:GRJu1<uUPY%K'105/'^W4GB3[jsNlI0J^hcZ?im<6pg$„U"G'tg'u]UL7xKki7e5a]VZEdLx2RN:ho*V9,GPS11Evc9_F)cT-z-J3,HMAs6)K)„U"_,lV31?/zE&./cGVVK5Dn+d4E-wcv1ku=A0ttq5.0l#CtM1b<kcK7Z46WbH7]6.„U"E1_/1Wu=l,jS+Y3K^UuVMt;6<[Si\9=KWM#)8e6QGnRs9-0W#nTNYf.p*V5#);[„U"tb%p/gF$Y^i:ATE>A;I+q2jO+gQMCPVreCeLvR34WP^eA/TdS6xXl7gf0O;8cT0„U"&7ApDa?v0^GKIR_0F5?i^elpM*;[74(JH)i#?Wy5A)2FfQBFyQ/H3?)N-xO2pD/„U"DEc'5PMQK=Ym(F0j>f5M+tcjWrv.Mya2q:#8aBIQ5;Xnm_1=<TVA>&m_F?aL>j;„U"6_(pbL2/CcTk5]G7Cem&;oEJ/?Vyd]5\T=6wDH<_<%eX4rxMxs/Gt^+5Sx7R)6g„U"ekg9Wc1/)Y,n_\f549Tvo0*'_p2zLq9HDdOMn2N/tG1_#Yr'JJ2ud:4bb3K:iJu„U"w<n=ON/q0Nuy:N1)y<Px[dv)44Xm>6^g\M<qnp:2.Vd<2?bYt.?tuNeTRMnZZtw„U"n7n&24O79pWgKjD$5caX21aYH'V7xl6djpFmD935n.x22KqdHkYfNu6ujN)D+-^„U"'ob3TQ\IPh.vVNzM$u+Bbt;1\<jIrRP;-x.9h3MQ)W'f;Q?i*_DV>Z_\w/Fh^)M„U"djgY,Vg?btSBTe8lAkoKHyIltK,KZM'L<xOOXK4DAMKt%#/#1X?.1mgY7pFOyRY„U"7*eu1&KD&>t8d.m/h[h<MT_w'Du'']pR,\W$[=_q*dL\wsouD(p5.GQw#:_\TZS„U"o/3&d*)_8271lQ#pEX1IeHrqQwsU0wtBen[XoPT_B4gnFO_w]*0hRuY:p%\-RSs„U"et1:K;x[a=c(,Sjr8K,#;lU,il;q&Y'>X=e)aHCnDaD;k(giqE9;fU2Y1[']OLJ„U"[KmqtjkL6^'ce8uZ9\Q)IujRlb&R=zi++RVw[p$F=0c'oltE;:Tfh4#Nt.dt<Z'„U"gkAl1VGcU*rxCHU?85ALJ0)VprCumG':Lz++q=dWp=)]K[b(Xcr-&H-9HUd^_0:„U"D];:.u7L7,XM&\/QDn*\-Fb4VPc.d,e)]o?$-^%JlHa_yS[;LH-cqL6s5e<e7gF„U"8*7LAug.fIYT[^zp7$WFWsLRBiHvmAT/dN,jOVjxTy28do8x[Mdx->39))JPkh/„U"[dA13fiH+XQWNj,-LHJL&gxe8-lg0qatv=KYAAwO[Xu#(8JKl*D[]N0jrSh,UF*„U":=MLCR[K56PL+U#<JH5#mJP?N4g]_))kLT?Dj8._./YPuh.epb7LIt[&B/Kk\8.„U"gHI2^v+s.UQ2boLbtpQkwgdx%'up(%)9%%%%-%h^N]Fa&IWfw%C%%t%s%%,%%%%„U"n(u'SiIthl+<fBT[?Kx'>'v4#rPnSmpsz$>2IY\l]t;D*'k]f)CFJb\W/SIkN7g„U"J9MWc.x/AF&5cVl+$K-PO;ft/*QP0XSCJ]Dw4t36M>'0)7.IWEt%/,zd,z.Rf&E„U"TYkS^2qe/[UGf#*av<w%#JASCa2F+%p+r7;Au9$(\jH%pPH86&C7/H[qTTU;M)&„U"E4[W5zZ3_co<\O([.k-O16i?t9rh6r92_edZ)R:+$lo4^=5)c=_22/sJ#26w4SJ„U"dHDAHpBR$Idm:U%UzzSZ<%x$02*4eOziJrrkV,J_CA3i29Ga&Xqs6dUM?w<l&%S„U"nX3m/qWR9V'#zn(Va8_ku69FCL#qSoq)/?c]C/+8:/?9dwO=UUjK%X$y'U_iz%X„U"Tz3)T-0\Gf:4TMTl=oGa+%wo-j3UeiR4g;8\-2V0QD'CfVGoNMe'wfO7%+Me=%K„U"h/&YQ</eK_H3sbkZR64?E(>?Z1,2&Ej<q.0BW[(4J0RE/b?RgxdJPRlUSCr/>Go„U"r3_X.lc&7>20r.;U+<gD0tg?03rmj?[Bj1B?L'^2CK1DRdz:FX$Pi.+dg[D0k(e„U"rIwCF6.;%ibYG+Cz4n[MprN?i=Qg\;)b4t\=lYd?Ff%XABR\tfAvQ&)dD_JqbTk„U"-ayN5uNxg%3LDgd='CGv%XH81N7TyBl8^IwVZ2tb=cmTtPqN+vm?#fftkrtN25N„U"GPkm&wVhL:I*dS)9AE[\Zd[G(u7BTr;PT*qR#_[#rFvX>2FvDaVOR?,e6\3VN#O„U"iOjanV1YCAr'Z#hJ[d\n;G6uzE_\j4tZ(h6kHxlN-g6kcu*YvXY*IH_37KMZ>if„U"(^)QBy#/>]oVsQpK-ty3HU5ZTBm&NmaT35Ca3=TamuA3n2(I1i(I9ZYw-iRK<bm„U"=pnY8Ue'\.$d92oqoOhc^qK%\4+<[SZOY-6^gFlfmdm8g_MDsu_qnB-BB5c]4:v„U"pCi8YcMaeC>I>He7TnQ9tUOC8F\r0.Hpt-um-lB0]1ipic*A\z^TEin?U9sQo?V„U"Q32ai2&-HR%HHNRo];2d,$MAv[V'PF1;ygAdtXW4%l)fM$g9-/O;2PyuqC,2CBo„U"o.H&mp(_w2hST=A-'<<v'\]]$&j?YBW1'8&kp0OX*H=cC]8]>w=V2D%f/Pd(UE_„U"_W$6zz^6ouJHa#]Y]$3yIJC(xK6b7MQ3%L5jvLp2oeW/%kZ.MX_[LLBVv$RyGT[„U"jwjpA*j[c;;[%B/Dp8RtM[bDQU#tjGYW6y4_)oQFVr+(N:%jg%=>rKL)(WA8[Gk„U"p,tfTU[Jp*rdo#X_bx:H;aFeEJ6;MqifXF['[qU=.Of\Uu-r96R^1iW0Y7>l\-U„U"MPY_==i[<wQ$5L%U[:$2RwM7p\+5;%_']I/*Z?4SIqZc?vw\^N9awH'2i)/_,D6„U"efgM9/obfw7?Xi)Jog)lod7/Ag20_SHYKBDMqJoB-29ZjYGTD$1fF$]*q1-Dpv3„U"VcF>lAh5',.HCrDTd5I2cMYLWHI$jG0?Nvp:o_^7%kLiZQ[Z;rfJloX]E.gpEKT„U"DkMq'+wgFjp0M66D9>*K#]9%*+A)K8kl')59,Mt/((=jOvAi,>gT.:EWP)P]nST„U"P9dr\tZPkWdOB+H)%pv>1nquQAO:Rd=Ge=/u:<Fx9f6n'>(k\H.B)?j=gTOq:%Q„U"fI9F*,U.rBk-=J<leZ:F+c?r]&+Tbxp_p#$UUq,8Hm0icuy5PYNPcKZ8>pgVvgG„U"N-Q/Dltq[_Q-AAuiAGJ[6$Z&3NUvbja4LV98q9DF0iFHbr>^Uh(r,>/GzYT(E4N„U"DmgA4^bF>:wVbW&y?r38O3D_3v_+R51r>8%Q>SC;N#hkVv?\o=;AP+pZtmmGP1'„U"#hWo1W&TaDq2gt=h:$Mr0YlA63OD+N-J51[auA72AnbJsHJ9*SOgCV6VZ^4Z'VG„U"[Dc7%<AI1xA>ETma6GUgo_hd#5PDLrPB;54R&#/U(4vAu]a4*PiRPUEQd6$b:TY„U"ogm2P^tj#]XEb.^AO#O=$xtjMqSvkwE$FhuH^rn=b[nPpTejj/poSnHurFB(lhk„U"Ia+E-V[eSb+pJ66a#oi3J$CRr>pKTwI;pY1FxBA4K1bs;fisrO253pDgu_0Wsyr„U"cR4EGRy/_NoEPev-zEsi<%B1e+B/h0C8(cHgSr-K/JcI9/LPr=qGj(<U#.l);SK„U"9Y5RZBIGVs#-U3aN&/*&*U%=1B/SBN.nWbAo;cjb2XIc;i7i[FA$06E=qCS>ju>„U"w6d;J]uK8&9ArGJpF^V0=5)hE_*]oNfUH6]nP\%A(:i*%hSCX=/OsoJ$AlF2aFU„U"1KPDCN37$T7AB3,F;DI8Asa)FSkA0;M5XG<u>KScAu0Fq):d'^NUNF+,wca-Hp6„U"<>kQXtVMJc&IH0q>KU'u&%m3msQ0kPV6?4OS+\.p9fcln2t8epY8qQQ7iUx<876„U"_$^PrH2R-Cw_h3qe;2*VdSj0<V$$2IeZ096AwXiG3XD4(10dqqq-at-GSl.I(8C„U"LY'mL(H*4>_mC23lM:Pf501wWZ8=X\)JEcX9?R]-3.Wka;&0Qhqua)\rbmpMF/)„U"aW8W+$ks2d/1OfURIcBmy,A?6u:oFi'(3DrfNG$J3*%j<^<pK1D0tHn*dq$+Z9V„U"=n<M4y3\4H48hIp2Z)B(&s.u6gpqP+%ENH6YhY[vk9eR5YP10Biuc6XlUhP'+iG„U",/waV$&%z85&ctg7I'kzdxbg%jzg\EBN'xE8[^rN-b.\5-\lXUi/=ATP_oKEZtb„U"p72Ft)PhY5[>Y<2VGZsZ\9GVUFj5PR)EcUu/LY5,:dC]2\zF[C-(8zdM5fe;9*8„U"_ZSx[q:Ur5BMjKD.pi]tMAYE<vBw(hVx?ju<)X<#aNL<+N]gv+GuJF][RL#<a;V„U"+).mAHcNW7kCYsUM^%iCp2&+K-S67.3ITLnL]7#H,huP&bjhpB&_yV6T?WT>'-L„U"KNq.OPf=Pk;rnuZxuZPtTu*NaE0mKtz=5r\F\t_vVr^haUhhg1jy8l]XhDsRr[h„U"ORr.V<ZaXBum8i\cmh6pD.VF#]XCY702E0m[d$mx<1g5Lsf:p4p'BimI0]7gaCd„U"TiuhJvVcew5:2hr>2Mtrtpuh?h7gXc^pg<GHkelj.-hZ]MqiWaMYoMRr&qPK18Z„U"9nq5>NEXd9Rbssb*sS74pX8pcX0+k0rWLY5uXjy6Y6Nz_OXEOVc<vTCY%z[OiWG„U"wd&H/<9b.R471dF5T<mb2)rkhnO'Q?Ug#YRp]f_*+,<gm3/3Spul?O9W)'S$Z,j„U"cgS7ixS[bl>4JQM>Xqh2D:%gi\8v]5IImuqqQ4M_M^oel5s>fQOFmU#gPy)'1Av„U"C(p/*f>mTi1ER.$>RH0DlYvVbu%Xtfc_oHE]'kX1a>HcW6WxEUtTJ>>rvGcwDJB„U"&FCD5U#Qx8#RRKx1kG[(TUiX/Io+2'(fY-W7u-5#W(M+-i0E9g(:'^cl,3l)ZGF„U"<?37ghcXt&3ZGiHe+7nhdup;d$xd#O\6n<A[*+iobM;Lm(8;jAMtz[&KkneL3[z„U"d]9];gJK[F(Wc<dGAaYYS)+#8._,0o1^qMWiL.Xn:1UyEyh50?7Ge83)U,f_Jnl„U"UpJ,Aabb4RN-cR9Kds#jh=K)ej1Kp,:Gi0YHAmRTeRv.N=DN?QD2ggCWC5FDv[m„U"LG1?B[$#(U;-UBK',N)6^Aqr#;/[LbJ,vTR90eqt[ayv[Y.w93,S3hZ2xtDyEc9„U".w*Y:1W=8SZa*]gYdN^M$RD<y0Vd_KdbnhB:M<$_X$RQ]LE3.Vhu;;c9Iq-G45b„U"Z3sk12J[dCt$%)%G6df_dR]vS)5M,4Fux<oBA&=Rd.hkWLj_xS&lq9h6dv$?3:+„U"t5y4kdpm$(Qh1hRiP)_bPlC<LjOM[37,(K(ER$EAofTzq]h$wZE,n3e>'A_MhiQ„U")J[>=s'odGb,[IxsQ-c=B=/0Uc0oN+OPDJmd1;s/t)bD]ZCC]q_f541,910=z]3„U"4+D:w>=9OGYN9B_S5qfUBiTYDNp2[#oI%M.'Qv*tYf-,M$H\K[;Qnm[kjcvJd8o„U"J=65i-JWE_7GghDro6nmLrnO>GIJt8Pn3.wE.YRBRHZu*Xr\;RamBG=X%#l_JkX„U"<:fq9Lf5EBF-49>QL$ZAdOp0KAreq?ASsIN^6kNm;yF=1i:Xj#8Y>gkF*6:14*L„U"iIb<ud.A(VB04eA.DSg,td4;uXil%TcTkk,H9mjU;*[gpD(Rc$3(>Cib_cL+abY„U"bMs?6&'0\yZEu6dd*/BDD]T%M(19;?/%/^=,7#%Wa(+dSWo3YB8PSdO9b_AbX4A„U"b4Z4?L/V?tE0g;5Kel(u5F]EahDj)H4p2M+H$3WyM_DaunLsI^57Z0old;BW./T„U"cceGVsYN^/iy1q+5yufoM$RnU4\0T-=o\vWycXO=3qXwLkn;mUQp<:[ZBbb*G\d„U"rZ$?('::tB^6zS^*RDW&n*ZZr5^(LeS&X.U_UQ'9,H6lhKU]<WO'8;.[yA9OmWq„U"pG1><(kj/3g:b;9mG;6H)9)y,;u.pE?0F^gAp])uKVP+WeE/zQqMpw''FBv4)7;„U"A[m4m];l'[ySeLQTyQojH[011g>HhzB3.?h'9-q'ribF*%:16[_(pnNO.8kUY^;„U"31wR>_rmU3$7=vObo*y'S:R.#ji_wpF=jHTb9:/-\e1*bdo_Q*2tsDOM9(892gG„U"eCs/NOK*k]\aat)Il%jr)DChfm&%yWMnmKmDUd)UFmBLV+g_u2yc\uWB**ojF5D„U"w2cKf7&:FV$.IX</+N_FK]O1o5)1e92G+h4r..=:gO#HLa068PElw7B^8I%jZOS„U"0468^;&aGeTA_mpW$fL6(0,i[foT)9\,<vC_+p9(]b]:G97FjYusZd2%D^Q&rJ3„U"i_vCs;\1En'TyXN4t5,#eWeH[-TbfD/:b?Qmkjq5sV7rPp.'>?AN)a'ShL[pF*O„U"l/1=M=wZr#EMaQ^n]f7$48cz\f7hOJ>QW-B8SbSyH]bpChXvp;YdjbDsQ^m\23E„U"M*aU6bxJ<aj5t3_s6QJ^;Kj4VpCAgkwuOVrCF)]hw^(J.B3P+P9xROv;CqKB:B*„U"0vS[)Ys1j;zTTqg%7P&V4%<n5\+lg=N.+Fp[[D3eLMAo,g<%(-uvCFcu)i/oHp%„U"C/BXbQ*D2vB+TVol2h&mgKCZi^;)>U)*Kyd#.aA.#V3g34Y7TReq5n*rh3.X+0Q„U"_Ut\Fygerp92O,.o7wI[k=_2y*S&ChlWS+_J&lj%RR1DKanr;-z<B(&]1Ie2IAD„END SUB„SUB V2„U"&tm&U4U+ExR4,&lA:p=8BrP?SJESy\<YmE+ezX=IM-?kSOsl,vO'NXarJg<fXJ9„U"e9uUhV3tNX<r?ft44u,jvmjE][\rb_s&Eo\:&Y75V=h&3ZP9hFuett#nGKD-;T2„U"J\)HT&QD/:/)jHP4^4aeDU7f6p)JW#)8eb[ihJ%ch&)r%:pm]%',UlKZdI]'B)/„U"6qAk&Ogk_p[_q*-5)*bo5_N'WE%lGf24k95,_o_K(*NUv>e9$o]E:Nc6\^WBV[&„U"AsVKcOFnA[/lT^zUgiF$X;A4Y=0A,o0Z%:vx.MiRLcK+oeT?EJK-je0zOS-%IKE„U"Jm7;J$_RJ^7pGM_RFNuL5LK)H-hFiv,/R2ngL^PspkRt6[Xz:qbeTB8#sbgm>^W„U"cip1[U-'?L&[1Hvs>dxG/jMB&]L$fh?5*3xpx8h;XU#c62O8PW7>kc?SkF25aPB„U"Qp%V6DI0E=CIi)9v:?YHd-pXg_JKcW90g*R4T/Gh*a%gb'lvIh3$iAZItKeYtB(„U"#g4]JY##uIvdln3gPHI'\Uj-?,?5.;MN:jwM3h$Tg45L>,Zb9?nglUJa023<LIB„U"<5D]a]=I;J'La*O\B3#gTloi(_%_3/T6NkVj-4#EUfBsw0if(A:zZJ%+6V)9Tbk„U"S81]\s^?=d5MhFl#WZV?ts]*8XfemJ-CQH.oX\mwc:XXn.=%&F9/GdhWG\eS\6(„U"W/F(L++maUCTWh'ts_i0'F,16U9.1Fk-N2SUpF[[/$nH7?t9Z8G+/?G4$KHg.RF„U"L?r61w;k-l?cs0iNcQ#&ko5o?H^9e;E**yD0nv*p<tW3m:]Wcg%=^ZTQb%V.B-t„U"FFnAj-U':\a/q*)7Lh:(eu:egtkk5xJ(Ue$DEeDb2Ta,lE$hxuk\<QVq.KY9&9Q„U"(Wac-][T7&7VsavcPF1%)7rLfST9-IwU'gTV?&.CIe1.WDUbGXW?WWFIXlp3\3h„U"eMFHp&d0ogF'D7[Da4bS0]KR=4/t]$o0K(YnUJ7<?l>=5[VNC=H733p:>Zqoi?y„U"#0-1=C*3d<<]M=bmP9/V$M24h)a.?j;.VtCcJc$WE0i4=KsWkSnRandw\3WIL'D„U"V0m*]qsp[9tt\NpA$*Y*_loLJ\$-tDQ9kEFw0+6,u=_T=_=W$=DGg[LYn)>PCfE„U"/f<?G9,aYZ?^wZ/6pO&rpaPkLj'04:o\(*XpRs_[H6ufm?)BfUnTg9UDqjxUH>Z„U"qT],.bL+*5;,u>fV\6Q([>Mtz\(r^/F6wXc5tCYV?o=5KPxs>m?XgB0n6-#.6xk„U"V1IpxulglPf#TH(H\(#(+PMZv8EkuHfu;I40HVU2LXV;b*39H9#grkG[1Lmi5zI„U"%3FVR1lLmg<q2rtONm^xcL%5:/&I3Hj]s_]XHcs6y8#BbR-Kb$1Qhz0Z_.(T]>:„U"hn8eAO($RJE&;sWW(G3]6UP+SU^RT+yMg4^/Zt3^Roct*T(1CZUMmu'Z\4z:*&\„U"t^lJWr5'[aCic>ZSqF3%luKBjDlDhnlujBRRX#ufb?%nP(c\a;D8]w1&%dDDx>r„U";'7/:DN.t2M+[nZzBQ;&vHh-R^0C]DJk<gxYUpZ?6a[10pN70rdpQQg.floPaLo„U"i?kE?0UmJ[W2lg\GHV>Btp=+KE?ya<TaG]O(l3AeU69D*Jv6-9X==:K2PAmDu(W„U"In^1gn=51r1,^LIMFdQT7^kK\7cJL62tEE\Hoh?lS>/Yw3z(.17$JHU%=CUg-P&„U"ZQ2g_V-[T%$GFRGF]dGa=:2hZpOU3CMGhC]2Fe%RqGXp;ZWR'(B]TlsLa4%8#z:„U"N/f,aapwk(-Gu/]un8-PKfsKCigMn*iG(KmV1SXg7qo=gO]^$)bm>--qMT-VP0w„U"IgvY^i*=ncTc26+.wz,c_;:cpLu%>hm72)Y%(U&a1OUt/#L//prou.9a/.GYG=:„U"rr?q\<Nxt^&90n=u]L4vmCRo\3Nzb8hY=N5Ks,UT;+#l.==0;Gsc#wM+GobB3xJ„U"KdB3kD=?+QBkfnr><m_'Oh.6(0H&:YYhA^GxW$9/<BE?c6$<G6*Ds[r-Xp$Z1?u„U"Wc*r]ZNWq7=0VbC=g\yFq4M1RB%,?;ZnP76l&IrBZ>Zi'KRFDKewgQjqH&+n7Ur„U"9T</SSn_+=/pxNr?F,jfA75+Bpnld1Hjzw/sT6h*#CiNz:bPi'9ilnm8)p#GYQx„U"KE#Bm6s-TAweUBj3&0.EJ=3nxjQ'.f1$SO<.al<=_QedNP9ka*0K\jc;ER*0Ain„U"l3Xp2*tn0nUC6#d+''SO_K]Rx#$_#NNiK.EXH&+WL(Sck:7d6h'B.nJ%1*61qZ$„U"+]IPiCLIke/FV$$Y3ekC-tSi'EFMKt\]V7ApX5pRGNeQKt=f:$5I^^tV7(uY)A$„U"Qe3%npDc2o8t?PfPcI0jp>L-l.MBZ?hRi'P%dV.fZA\3Zti6wdD5Wj<PW;ZL6PW„U"D*8fUnYG=4]#Z7?7/i^1VF[:I:,8)?Cj7bO.*qzuIVzpev[O;H657:u[N,LLibl„U"7afnmgaYUKvm=:aJx^9mq2<te+THMT-sJ<><A<UJ7v)3[<es9jApt:*XQY'YMax„U"tdi^3FPrZgOGG^wbeSGMFF5l=8.M\T\96wWMuuGe7=0r#(GGT\^;xglj\KV2TS8„U"2<$+x'hO4Iy1e]3o[;yvZMN;?MZKIgA]tf0pQbSot38]7gzMxypKi#^rcP8%;VB„U"bamOBcqsn9ew5]m6w3%DJrtM&t$81jl)aQ_i<Loe.X>*BR-Zt6FDKs1<>4=U=l1„U"nlD$>+dM'?r6Z_K[c26&XYWIh,cB(XF5Bw?]F-(1]9q%)I?d^K26=Hg;7-yEY([„U"p,iYrXLWk?Yl(jgNKZBGv[cr<C3)LFc0m/VNkZ8DZLfq/5f&#43z?h$'W'8bKxl„U"GF[M)bX?CaU7X8F0$p1)p#U4K8GjVdgzkRlSbQ='LyJ=:gJ<pHn.1eW.WewxZEb„U"7.Tw%F5s-\ph5.7HrV&$2<M.#xYGkq$;0ibKL+PC4U+tk<:[NMdk</]SQEB?L8R„U"xR$)?,w'j37AJJWGLi8UsJS=&J899Xakx:l(OsTG%Z^,Do1j6<ae'$V#hR\Zt^_„U"E'opW_+gHBE_&>5&[qWUmXT3Ct=tNS0Wh,9epSM0F[O:I>H;%xWC2RuR)LXFi\X„U"V?Ejn0>h0?\+'0eqOwgM;25E&oeeKKt;n$kO's?In?kOHN<QanKd=MZ$v3%>^X-„U"8.f95L%EP+Y\((Vr$fhi74/c^aMH6aV_l7*dDqa<.L3B^Ac#%QJcH^RMrZfzBKC„U"g..h*]WJOofF^H1)l^KR%k'.mI1#=ZD/IF+r,:-K5DM.^>MKxUh-tlXWErg>(6$„U"^D4nQO#78h#\s5-Ri\RPkXL/1dU)9n1Rip:.bwMpqSvF>,0.:ev.?QrITX67ZGF„U"-MEYkaV/N0wbu]gPqK#]Qp/RW[1MKH('Z(97QtL[DfKbZVKj_KTi6<LSMcC?Hpn„U"g'^u#$P0KLVZ*'1F;R.$$^W*F8g7N<'%):A/dJ(-8pO+svC<NIgI[7HUtjod?Aa„U"hChyG2s[[VuRM7#1<My%TUsj)\2zA>sCb#:t4aEAQ2xSaEMY1(kxnU,L[;5p(>z„U"4k>-[&n-p+IYT3=;T]okImOVt'j]nF6KpIN;2)(uvIkXmec8J]mo0VJkKCjfjve„U"#bhG9?\&.^H6OSqh>jS'N\IQo-,iN:r,#%[Z=uXJ$lf2b(5h<RlA;2HiSL.VaaQ„U"f[6$MboK%9Z\g'seX^,.EZ<HIXOAnJTiUS-7e_uJdB.m3Xn:&4i0.SgK=#us#/4„U"hR,USbnJWTd[J#,i?0NH'tk-\&ds%i]qoHg<kftjWUgV-2Tc\QQBWHs_%gNN^y)„U"n+ZW(3nf)dVS:5'8sJSIPRhX2BVT<R]9=v-Wn73mE#)tTC*eLYmmCN59<B*;Jo2„U"Xloh#Y'r&'LWQ/0Gb%wFBY=^GGaWVuTL?3Xsg(2,zi>>+K=lXYr\dU[=3lv_Ohb„U"Lr5qgPOSB$=F4rf3(=YGWc84E1CoJ<[yKHbA6s>GQu1JhU(=)7UsbQfs7>-EuFV„U"$GZ?-<tPFEAQ8]9-&)fgI7v<WW<r*n1d\uZ:7fw#I%F1&AmJoQoV1a+2D;*=E]T„U"V^/ci1q0=L>DpF]^>(o'RT(kMHNV4jSxEG9Gi?VtE<(uCBITB-z[.O22.$c]Gd#„U"W[u(.P%kz\NtWzG;IB4lJ-La:6LGObSC=-FH*T<PB;wOCgUSC2dOUp_PAVjbh&>„U"-<ubBtNJ.FWSaZNj_Y,?tV]:>Rq>y+ciP/*.PJ):S>5%A/Nf%I$PN.>)Wk\<S:?„U"4.qOnbNnO5be<uVABa(Etlnp(jRVm=B8u)D>78M7C&?.k:IekBqzr\n]IIU&TV<„U"kr^-i*GJC,<0U:V2&.JNOPQ(xqWh^pv(]fn$j.01x5b<wQ/KN(MpXS(0-BT[2Tp„U"[6Qgz8;&]YG=o#F>Z&,t+$4Ht3,]*kai6UHB+y=0^tz6p7$-.;g$#r]bROdwa/a„U"E&B3'=m'TT9/F1'-*awRRIBQamVzE>Ps(qb:O/ht;wyI,>B5OjuX6IhX21lyjuS„U"uXU*$PQ[GN_dkl*AF?V/H+K7d*B3OOpG=,*hUlG2=km,_vopp\s68NZ^3t-5CYc„U"rHd8<9Vx4%up()%9%%%%-%TNS]F1/'D#>77%%,m%%%-%%%%hm%fySg7fxfa;:FT„U"[6+XBsuw<MF+h7zzWT8L=i,=^%sl%4+B]PO\64X/6)aGi&I/.)zuv)8v/1%_)df„U"u#Kbkfb$u'S\A-=E%=$EJe8Huo0Ke-cLka7Uth03$VJjtYN+t7*2cC+rC358=%U„U"/Z;CtF7sWDju5Ce?Hao36?JLg8ah$-==KrwWtIss.d=]KkBaMt>FuW#)F6(-WW,„U":[i?cLAqqCV\#qIaU*O8:G*YZ2:B\M:c0N+JVLtxUOtewp2JZt(G#pYi^)>FV:c„U"-#hs]52HoUSt<gi%+kbJ]WV9%#'fibe[<nh3a<h/8WrG#p=2,p/rT4L#a;7+'&6„U"8^YHE*O0keY&jh\1g8iuIB3^qwlQl3lo%2k4V+owqUD-LNX9HjJkL//*)u0;x57„U"n8qj3l7*dnbZc4lbQXIk<A6/Ln+wrfjBs]1T4^(C00?9HAgZT:*F?i<FbW/KYle„U"$)ZHjSmLZgUdVOKXrjt#?AdaH)_A&H\e/7#LYK-$Jb'3mUJ;G$YLIs\RI62^>x6„U"X'puQErFz=mA\?eB^lcL4=CMWZTBwY%D9Kn/8,_I:/2;aE9uGupTX&Ea9tMQJ4A„U"vtI5op3j4(76WDo5BEMo<PX<kmh0XVZMdHg=[KaW7V<#Ep<uRI1a_RZS<:s=41B„U"?kV]67e]w_x(Hf+48c.AzTvO_Z[2)GB#;Gpw$>zfhVyG%uIAl;2VC43+930+k4(„U"3yT2F5p[/^Gy$eyqSR\WA/_?,J]Rfu<kd?,ZTB4o2N9Nn8a<u:<:JQfVJm;;QVg„U"mHo-j#eXaH)w[9IRTY[ELP&*.NH:LSU.(nGW?S$CW^_=k4SLuF6Xo#M,Wwndup5„U"JP==\d$$_0;#[8O1xWN[k&NUN<RcXdv<Y;xo\QB'\-I]0%B3Dt,xF7Kin*]iS[A„U"xcQ&K1M*X4Zq]Vp<3xrid\rG9tktYm:8,STskNw4l+-<Prr5lA\O[3.nX4Z'Sm>„U"lP$+VTR_K9nNO0rF5Th/kI<YIof9>T>/iI3F&7'i%d&6<j9A0ecL63d_N&V6dOh„U"c^=sE1gGp+L^W=9dlHY:\P('^v*&fF,]Sh5s\8lFUvNGHQq*b^Uy0_0i.$S(*<A„U"8v7=:n60IoVX%Y$R,8H*X<S4[&U:t+_f?+l-d:i0KM12wm8.Ib^r>u#[=<5^E9l„U"8<fIKLFHCJu$Ee\(nPiwFe#/-4[2;rTi[d%nLY7>]k)x)w/aHQjk\*-iM9)8;gZ„U"7f9*5YTPZ9Xv2=,DwYsaN'r#_x1r0t.NI(>7Ep-+iY(k-/)L,.57Nl=>AN9M:/c„U"U2A69(niz&l4x1S<lP(.v>Cj,R/Z6Zi#iIO4/0&Kv=%8k'T#O'cTYM#fmuqjmDX„U"X]ZP6_OUNL(=61Q?gt&<]Y2ZVjQY[Hr=rAWM7\QuIOxB.4,t()cgU<Z)pYDrOa_„U"FM?MtF(6Z0mP/:nn/agm2U>PmCU$AOT%m=[q_ocw+CE,\H2AM8UNc-+i:.N*jJ)„U"gx+B3Q]GH#[[9h>II*ZX_bUaB<nQ(Nv2OMv;M)Vb\+*Y\>^W7oCK'Au?_#89)n^„U"ch1gf_c0HXR5Ct]g8s;%*nj/nk:-Gs$/$k4vA4Kl9N879x1JwJQpk,E;dzbk.h8„U"=&%c'n$??k;E1kFP=*XgW,POQ7W)^['81ObjUCA_rIu-+*mS%_PMrooq^N[l:SK„U"U:(97cp6^e(ud^lW0UUWTc9rkdq)u./a^FNm#A'1\3BM\Cv?Mrf?%uJ0klQ7QwO„U"Bt(=2k5i\(W6Sj/HK;Lv#ZO=]--^GJI=?Y4gg%*Cpii(9c1]pak,Hm.-Gc)E6iF„U";^odKM8$LS(vD_$]T\bqpwnXfH6Nrt#7rH)X0?Z>.rCHspa0>'gsEb;iCT#J_:'„U"=A30KMg-0_7LQuo;CVu><m%z]AmsY>y9$qLj488d]1d;'f#?Tr'NuWZRxE'Bu.<„U"tazOpAjb30Uc>d?L+vEg.AU[C66h9H>:L7rfQ(UxUEc-FiD?oOZ:m8k5[RMIm%h„U"kxvqrOjeo$uA<tED541Y]ByIvVPINlx1w+p]_*1qAPuDW41N4.$MBeiW)Ai6T4;„U"otpq&j$4lH5+vhSMfwBKhxqA.$[Jq9\y9YPgIT/i$OtE#5?CrIsy/I%98k:bF95„U"k*f2]3i1sxvVTJ=(7^XdM#4.JEp*<W-?FDSr%1T^i9,-AF7D7xxP7G>K]2IoXZV„U"b^CM+B>9G>L[p7;;di1Y4rviCW'kXFI/u$;'*r)T(0YhE9afY':rhkfuWTJE],U„U"OS4q5Msi'q[JVDoto]nTiuwmTjDCI0J,QtgT,vKTIN\rOck$EY\WHNKSu0FoK%Q„U"nM0h8qQ0A7pJOeF2a5g6+,pD'a*T[Cng2BuczIKNt_z,)6zaXyO[)-q.?9*\bGU„U"pcLs=d)_t'Nbb$*.qv?).kWgLOqDGz8%rM^&\r=SSp#m)8)ljFqUIA2lpPrj/o+„U"ZQq=_FJZ+]*5KaC^A>hi&gOx/]>Dx'\SX(ShY:Z0_)iiFyo[lqmnO+\YJ\ADD5J„U"12:a_S'*OEIlaT5wgq?9;>/O0Fw'd/2iEbW1JOA%t%0%4=gqJ0;-&LnP^,&WS:g„U"BJQx\tB<UPsl,K$sI[KK^\Q=V:CrS&*jCK]Z;?q+.m8YriPZAT6%gHyGeyW7b_1„U"5y#'HhSwbIS35)v7IUK8grhTfy?(;GyRDBoy[TcHly,W3v3wMHy8ef]Vp^hm5n^„U"D45r-Y5Oa43E#esY1O]6J;?]n\8EwnmY[7#0Ly89?oAcRRY-$JU7X;m%?0I]J_)„U"<jR7vEH[hsx(*$#R)6C]Y<gk1O-M-+nlVDKAR(,iAIhXSq<D'?;uG<fX<%vz0\S„U")bG4T6(PAEVSB/dhz5vgFZc>ekl.<+JEl\b';W/1x2HqH]%U$7_L%(G9<'R-4JA„U"1.ZQ0qow[qvI>?mb\b_e6MYSto,tCbm%Iu:Zo<PtW1x'b,;yb,_2MmNR[y<gj*V„U"k^_MN3S1t+gVd4)=i-fQkz.Cervg(7LyOZ>Df[P,FajOz5S.gSpT5Kv+-lY%k^f„U"'><$>-n'wj'?ZaJDx4Du<O-jf[*2uWr>ovVRxmp35fP,_dUtq>1Kq<E(6JNEX78„U";W5h)us&1t37.7;kb'IIJGo[qD3%E#z=/Y^*>Y6$<Nl&oNwcVrtr8PPhNmmGS)9„U"$_+oJ8,=G^OK)eehx7vfdT6Hatn/q21$xw$]z/vg_n\Xi%eD%tRE<J.ojwYm\s2„U"aB5=A[ARfH\$l2YC4.%Im'LN+6P*a%csF\d./oH\8Oo;R^PSjCQ*<]lq0R^ZC>i„U"J.N$8a]oAY&zxep/x2;ysI](k.QD23x-BDrJH4fnH?52)=gRj.()e+l*hV*uZVh„U"avt\)SqN2fiLn)eMyszyEi87=uTETu$tc-5:w?eBI;V%Y3&AS#>_<B#)>dUMV9)„U"33MvcL+8xJZ,$dG7kq\BgwZ\FLc%alv1:2DW6by5(7PRBw&?$%jgR;xu8:hx'le„U"b,r3%DpFQRJkQUM72=x&j8ZIACpGuMRU[XRM+[r,/GIopJQcB&SOfqiaaz1MGXa„U"XL>RYb*64s&b*e2UF#Xl'-g6$kSz]<Eg&Y#kWKj^='aF:.fXu'iIQ30fR..&v1Y„U"]e73O'7j-;)Lqt7v:I3>EdV'$$Jg0mD$M&AC\[$j5bh,_+36^I<rH=y=xBGhGm#„U"5N>T3^MeiPAMZXWo&t>ZZrA5t\iDNHAa**1Wg_i4\tyW=i<2KX.uoe0gvAt;CGt„U"dy2nSE%eH$hG]V=X90tG7z)YJ9OQiggM]\NgY(zaK5(^UU&/.YPE>Bd0Q-c5PG>„U"#Gk+?AP$OjiM%TejQ2*O]<mnC^FB15cQH)&e[UQ=,6A89Laau*rxmW_y%5ksK*_„U"4%BtHFf:=$d39u*,&IVJ4WC^]#GeN,kTN/,4P#0c<S>y[Z^lYm=U#Rqq;^rKa^l„U"^Kcd2)tY/G;3TQpLUJk>jqE03<gq\$:ZNgazlYV%eH.hLA4rSgD.8XraW=leM::„U"47:jL22U,fouH>'9g'4/.V2&yt49F7BotSMeh[Y3'rix6mVBl$-PRyRQ$:+k+o&„U"9:l$dD$p(7DxlGT?O8UD^[,A4vVO;q+*XATE/D*,sRM^DUy4/fE7A;SHS%M,GTq„U"hCMV76zd_)1k1**El,fQ([K_tgZ3RCn2_Zro(r)VWp$ZMegNE.e^n-nd)/]ko6w„U"C^s9)oS'uw'ieyJxL]$l_IcK-x[z-P0F15Ff5=exZY<aZmebIStt;2E,J0#xz/]„U"qd%Ji.]e89(pV_0jo^#x:QE7MjW93&:f:'%]r40^BwD2:xjrQ?x:#_x^x6'JG1f„U"4^9'hJJC,7Tq:?kJ>wWrC2<ES9/T^5d#b#%7IO3[8dp+5nlomg+5;-QoazES;$\„U"M?W*mZIbnNl<M<tI/)K<x4,'RCzFOV)p<toS?+Y9An\VQmPq<%KeqQkT0QuJPA^„U"=JIVf+%Y?&n[xCnWof.t0UTDV:U&Fff?/VEokP#6NX,diogCj,bKKtskoA5KeXu„U"H:q]ovcdIApo5qlu=8.3>Hv9Xz:GeT<Xf[F#H6GPKr^l,?O#Udro0O(7D1aX$?\„U"ctvt'S;.pVPQtpqFQhuTI<((2SO+rrv#Q>20hpJ/qfq\fJN#Tq=Mc8<xHZ*VoK'„U"OJ_#u-WIYJLP)I]<8k;\n?Gxt_uGu>T9a*jW$X(9O7b)eSjvx(1Pnt2oV[1/oa4„U"bRPvcO.TTC(?8nVXL2x,$t#<DBaK^AK2rD#.)MI+qu7MTtMhtuR+4lH*m+[>3[X„U"2x\'l8-2fs_LvxqBxxj\w:jgn%z1[YY%X9[\wB8&SbPx43=-F8xYoc;pxbJ_m.v„U"=A*>OJ?D,hZB:$hACsza&+l0qr.>J7,IowBtqOx_%o3?[-g8jI%+tDAmk4&ma?N„U"n*KnjzdJQR$OTaY=#;H[=cTq9WYQLz>C?Dj/tsCUqs=er[zCd92CmTCOtGil$-P„U"cJWuvdsh<=;J>:,4z8hu;RA(C(A>vbkqg.MU\ZCKn(<??$0xla&:-2)Tm>e7DaA„U"+0g9ECVh)l^QWlq.*V-2(%f4d%c6'-C9b+\je^;)ff*Cnc^NkmuIE:9k&qlz4[l„U"EmRgk,Z/n5Rw,vJhQ&*N5?FVU\%4<p2j8.P0cfA;M+?HuWgLS.za$81_DU/pO]c„U"lQ.mt:*=qI0j\LMROt9w'Q,6yyPMCD4tkLf'O/YUsZGe:KD?*s.a7roBlq1DkK[„U"?2,C:u;77Os6]5D%Lcu0wP=3#Ye2fai?G9?9g6qJ^x_^Ld0HE*FuzX7mSI%U-oR„U"Xk>.P/Rv8,ZC*#X;cHfTA.)ot0n_:pW<D3F4luZ^r.m=>Va&W^qyWd#h-yLm*?R„U"H#X4wh='uVTO,zuY,6d]>3<Sp)bh+ZP&o:GqNr-,o7Q179/J?nrXoFS=$=#'CP?„U"G'&i1W662^X+16H#RB&+4Jbh1Y%28QDb:+lG48$oCaNWk'lzjH$6y.7b-THAKF<„U"PpV>w+fN6-q'OLV1=yx'fWa\?/A>IR.kEky>fR>sRS1fLCbh>l-;6g8Jh&-,jR(„U"3keJter]%R(n]0'NjdXL)x/RhXD\)ECdto+d^HIXyvKrnvQ4mG<CX]tcRX.6daS„U"%^wVu-hCRItIs,h?mGGq5JMJrb#QxPoV/DbtPa\H1RXfaQRK2&^CV(ulBk*P-q#„U"OWP5WTo4KvFvtUq,1,E7IvQ%WqDOtN\Pu&,tw:t#KjukpJ,C$eD)?cu*(9Ex=d;„U"AWrR/V,iQ527>cp5raCqxyA5Qr1ZJD&ML2lv>\C+DUe8J72,eVRG&-r2W,,+xq3„U"ShMG,0cx7dv0Jm-36rAnCXFTmv+bc6X6?C&,XfvZA:ChwkN[[M4P3;\\m6BD1Dv„U"%u>a5w/$jd1p6I#[nkY09&-61I'r.\j,i%To>gp<P0>S[GYE=^p8u%p&'9%%9%%„U"[%-%3CM]Fx2X==I%+%%i%>%%,%%%%%%%%%&%%E%%%%%%%#%nu'%Sgfx%up&'%9%„U"9%%%%-%.0N]Ffd6O0&N-%%&]C%%%-%%%%%%%%%&%E%%%%n+%%%nu&'xSg%fxup%„U"&'9%%9%%%%-%AN\]F)R'PK.-7%%?A%%%-%%%%%%%%%&%%E%%%'g3%%.nu'w%Sgf„U"x%up&'%9%9%%%%-%.hN]F*aIWf%wC%%%ts%%%,%%%%%%%%%&%E%%%%B<%%%nu&'„U"Sit%hup&%'9%9%%%%-#%TN]jF1/D%#>7%+%,m%%%-%%%%%%%%%&%E#%%%c%Z%%h„U"%mfyS%gfxu%p*+%%%%%*%%*%1[&%%L%l%%%%%„END SUB„V2„CLOSE:IF S=69AND B&=Z&THEN?" :) Ok!"ELSE?" :( Bad!„SUB U(A$):FOR A=1TO LEN(A$):C=ASC(MID$(A$,A))-37:IF C<0THEN C=91+C*32„IF K<4THEN K=C+243ELSE?#1,CHR$(C+(K MOD 3)*86);:K=K\3:B&=B&+1„S=(S+C)AND 255:NEXT:LOCATE,1:?STRING$(B&*50\Z&,219);:END SUB„Michael G. Stewart             NETWORK ACCESSORY WITH EMAILINGmikegs@juno.com                08-26-97 (14:44)       QB, QBasic, PDS        888  19398    QNET.BAS    'Access Levels (Logon.Level)„' 1 = System Operator (SysOp)„' 2 = Registered User„' 3 = Guest„'--------------------„'To End Program, Press [ESC] After Logging Off„'--------------------„'This Is A Program To Assist Networks.„'Put QBasic On The Network Drive.„'Run This Program From Any Directory.„'The First Time You Run It, It Will Set Up The Files„' In The Same Directory QBasic Is In.„'All Files Can Be Accessed At The Same Time.„'You Need To Write Up A Network Information Page.„' Save It As "info.net" In The Directory That QBasic„' Is In.„'--------------------„'If you wish to use this code (or any parts of it)„' in a program of your own, then do so, but realize„' this is under no warranty of any kind. The only thing„' I ask you to do is include my name in your program.„'--------------------„'QNET (C) 1997 Arrowhead Corporation, Public Domain.„'mikegs@juno.com„'--------------------„'Have Fun!„DECLARE SUB winterm ()„DECLARE SUB winnote ()„DECLARE SUB newpass ()„DECLARE SUB info ()„DECLARE SUB wincalc ()„DECLARE SUB wincal ()„DECLARE SUB deletemail ()„DECLARE SUB logoff ()„DECLARE FUNCTION linput$ ()„DECLARE SUB writemail ()„DECLARE SUB bluescreen ()„DECLARE SUB readmail ()„DECLARE SUB viewinfo ()„DECLARE SUB killuser ()„DECLARE SUB sususer ()„DECLARE SUB settimedate ()„DECLARE SUB windows ()„DECLARE SUB dos ()„DECLARE SUB email ()„DECLARE SUB keywait ()„DECLARE SUB adduser ()„DECLARE FUNCTION Menu% ()„DECLARE SUB mainmenu ()„DECLARE FUNCTION sinput$ (Text$)„DECLARE SUB login ()„DECLARE SUB center (Row%, Text$)„DECLARE SUB drawscreen (title$)„DECLARE SUB percent (Row%, Col%, pct%)„drawscreen "Welcome! Loading And Starting QNet 1.0"„percent 10, 15, 0„DIM SHARED options(1 TO 9) AS STRING * 20„TYPE mun„ num AS INTEGER„END TYPE„DIM SHARED N AS mun„TYPE user„ login AS STRING * 7„ password AS STRING * 7„ level AS INTEGER„END TYPE„DIM SHARED logon AS user„TYPE mail„ from AS STRING * 7„ going AS STRING * 7„ subject AS STRING * 50„ id AS STRING * 50„ message AS STRING * 800„END TYPE„DIM SHARED emails AS mail„TYPE info„ login AS STRING * 7„ firstname AS STRING * 10„ lastname AS STRING * 10„ midini AS STRING * 1„ number AS INTEGER„END TYPE„DIM SHARED file AS info„SLEEP 1„percent 10, 15, 34„ON ERROR GOTO setup„OPEN "user.net" FOR INPUT AS #1„CLOSE„ON ERROR GOTO 0„OPEN "user.net" FOR RANDOM AS #1„OPEN "info.net" FOR RANDOM AS #2„OPEN "num.net" FOR RANDOM AS #3„setupdone:„SLEEP 1„percent 10, 15, 64„SLEEP 1„percent 10, 15, 100„login„„setup:„CLOSE„BEEP„percent 10, 15, 50„center 13, "Input SysOp Password:          "„LOCATE 13, 47„pass1$ = sinput$("")„center 14, "Confirm SO Password:           "„LOCATE 14, 47„pass2$ = sinput$("")„IF pass1$ = pass2$ THEN pass$ = pass1$ ELSE BEEP: GOTO setup„N.num = 2„logon.login = "Guest"„logon.password = "NONE"„logon.level = 3„file.login = "Guest"„file.firstname = "Guest"„file.lastname = "Guest"„file.midini = ""„file.number = 1„OPEN "user.net" FOR RANDOM AS #1„OPEN "info.net" FOR RANDOM AS #2„OPEN "num.net" FOR RANDOM AS #3„PUT #3, 1, N„PUT #1, 1, logon„PUT #2, 1, file„logon.login = "Sysop"„logon.password = pass$„logon.level = 1„file.login = "Sysop"„file.firstname = "System"„file.lastname = "Operator"„file.midini = ""„file.number = 2„PUT #1, 2, logon„PUT #2, 2, file„GOTO setupdone„RESUME„„SUB adduser„drawscreen "Register/Add User"„COLOR 15, 0„LOCATE 4, 1„PRINT "First Name:           "„PRINT "Last Name:           "„PRINT "Middle Initial:   "„PRINT "Login Name:         "„PRINT "Password:         "„LOCATE 4, 13: INPUT "", firstname$„LOCATE 5, 12: INPUT "", lastname$„LOCATE 6, 17: INPUT "", midini$„LOCATE 7, 13: INPUT "", logins$„LOCATE 8, 11: password$ = sinput$("")„a% = logon.level„N.num = N.num + 1„PRINT "User Number:"; N.num„PRINT "User Added!"„file.firstname = firstname$„file.lastname = lastname$„file.midini = midini$„file.login = logins$„file.number = N.num„logon.login = logins$„logon.password = password$„logon.level = 2„PUT #1, file.number, logon„PUT #2, file.number, file„PUT #3, 1, N„IF a% = 3 THEN„GET #1, 1, logon„GET #2, 1, file„ELSEIF a% = 1 THEN„GET #1, 2, logon„GET #2, 2, file„END IF„SLEEP 3„mainmenu„END SUB„„SUB bluescreen„COLOR 15, 1„FOR a% = 3 TO 23„ LOCATE a%, 1„ PRINT SPACE$(80)„NEXT a%„END SUB„„SUB center (Row%, Text$)„LOCATE Row%, 41 - (LEN(Text$) / 2)„PRINT Text$„END SUB„„SUB deletemail„files$ = logon.login + ".eml"„KILL files$„drawscreen "E-Mail File Deleted!"„SLEEP 3„email„END SUB„„SUB dos„CLS„PRINT "To Return To This Program, Type 'Exit'."„SHELL„PRINT "Ending DOS Shell"„SLEEP 3„mainmenu„END SUB„„SUB drawscreen (title$)„COLOR 7, 0„CLS„COLOR 15, 1„PRINT SPACE$(80)„center 1, " QNET V 1.1 by Arrowhead Corporation "„FOR a% = 3 TO 23„ LOCATE a%„ PRINT STRING$(80, 177)„NEXT a%„COLOR 7, 0„center 2, title$„END SUB„„SUB email„drawscreen "E-Mail Menu"„options$(1) = "Read Mail"„options$(2) = "Write Mail"„options$(3) = "Delete Mail"„options$(4) = "Main Menu"„options$(5) = "Logoff"„FOR a% = 6 TO 9„ options$(a%) = "----"„NEXT a%„DO„ o = Menu%„ IF o = 1 THEN readmail„ IF o = 2 THEN writemail„ IF o = 3 THEN deletemail„ IF o = 4 THEN mainmenu„ IF o = 5 THEN logoff„ IF o > 5 THEN BEEP„LOOP„„„„„END SUB„„SUB info„drawscreen "QNET Information"„bluescreen„OPEN "info.net" FOR BINARY AS #4„FOR a% = 4 TO 24„ LOCATE a%, 1„ IF EOF(4) THEN EXIT FOR„ LINE INPUT #4, infos$„ PRINT infos$„NEXT a%„keywait„CLOSE #4„mainmenu„END SUB„„SUB keywait„WHILE INKEY$ = "": WEND„END SUB„„SUB killuser„drawscreen "Delete User"„LOCATE 5, 1: PRINT "Input Number or Login or Name:           "„LOCATE 5, 32: INPUT "", look$„b% = 0„DO„ b% = b% + 1„ LOCATE 6, 1„ PRINT "Searching Files For: "; look$; "! "„ IF b% < 11 THEN„  percent 7, 15, 0„  FOR a% = b% TO 10„   GET #2, a%, file„   IF file.firstname = look$ THEN b% = 51: EXIT FOR„   IF file.lastname = look$ THEN b% = 51: EXIT FOR„   IF file.number = VAL(look$) THEN b% = 51: EXIT FOR„   IF file.login = look$ THEN b% = 51: EXIT FOR„  NEXT a%„  b% = 11„ END IF„ IF b% > 10 AND b% < 21 THEN„  percent 7, 15, 20„  FOR a% = b% TO 20„   GET #2, a%, file„   IF file.firstname = look$ THEN b% = 51: EXIT FOR„   IF file.lastname = look$ THEN b% = 51: EXIT FOR„   IF file.number = VAL(look$) THEN b% = 51: EXIT FOR„   IF file.login = look$ THEN b% = 51: EXIT FOR„  NEXT a%„  b% = 21„ END IF„ IF b% > 20 AND b% < 31 THEN„  percent 7, 15, 40„  FOR a% = b% TO 30„   GET #2, a%, file„   IF file.firstname = look$ THEN b% = 51: EXIT FOR„   IF file.lastname = look$ THEN b% = 51: EXIT FOR„   IF file.number = VAL(look$) THEN b% = 51: EXIT FOR„   IF file.login = look$ THEN b% = 51: EXIT FOR„  NEXT a%„  b% = 31„ END IF„ IF b% > 30 AND b% < 41 THEN„  percent 7, 15, 60„  FOR a% = b% TO 40„   GET #2, a%, file„   IF file.firstname = look$ THEN b% = 51: EXIT FOR„   IF file.lastname = look$ THEN b% = 51: EXIT FOR„   IF file.number = VAL(look$) THEN b% = 51: EXIT FOR„   IF file.login = look$ THEN b% = 51: EXIT FOR„  NEXT a%„  b% = 41„ END IF„ IF b% > 40 AND b% < 51 THEN„  percent 7, 15, 80„  FOR a% = b% TO 20„   GET #2, a%, file„   IF file.firstname = look$ THEN b% = 51: EXIT FOR„   IF file.lastname = look$ THEN b% = 51: EXIT FOR„   IF file.number = VAL(look$) THEN b% = 51: EXIT FOR„   IF file.login = look$ THEN b% = 51: EXIT FOR„  NEXT a%„  b% = 52„ END IF„ IF b% = 52 THEN„  PRINT "No Match Found!"„  SLEEP 3„  GET #2, 2, file„  mainmenu„ END IF„ BEEP„ PRINT "Delete"; file.number, file.login, file.firstname; " "; file.midini; ", "; file.lastname; " ";„ INPUT "? Y,N: ", del$„ IF UCASE$(del$) <> "N" THEN EXIT DO„LOOP„file.login = ""„file.firstname = ""„file.midini = ""„file.lastname = ""„logon.login = ""„logon.password = ""„logon.level = 1„PUT #1, file.number, logon„PUT #2, file.number, file„PRINT "Deleted!"„BEEP„SLEEP 3„GET #1, 2, logon„GET #2, 2, file„mainmenu„END SUB„„FUNCTION linput$„DO„ LOCATE CSRLIN, POS(1), 1„ a = a + 1„ kbd$ = ""„ DO WHILE kbd$ = ""„  kbd$ = ""„  kbd$ = INKEY$„ LOOP„ IF kbd$ = CHR$(13) THEN EXIT DO„ IF kbd$ = CHR$(8) THEN„  in$ = LEFT$(in$, a - 1)„  a = a - 1„  LOCATE CSRLIN, POS(1) - 1„  PRINT " "„  LOCATE CSRLIN, POS(1) - 1„ ELSE„  in$ = in$ + kbd$„  a = a + 1„  PRINT kbd$;„ END IF„LOOP„„linput$ = in$„„„„END FUNCTION„„SUB login„drawscreen "Login"„COLOR 15, 0„LOCATE 4„PRINT SPACE$(160)„center 4, "Please Enter Your Login Name And Password."„center 5, "If You Are Not A Registered User, Type 'Guest' At The Prompt."„center 9, "Login Name:         "„center 11, "Password:           "„LOCATE 9, 43: INPUT "", logins$„IF logins$ = "Guest" THEN„ GET #1, 1, logon„ GET #2, 1, file„ LOCATE 11, 43„ PRINT logon.password„ GOSUB goahead„END IF„LOCATE 11, 43: pass$ = sinput$("")„logins$ = LEFT$(logins$ + "       ", 7)„pass$ = LEFT$(pass$ + "       ", 7)„DO„ a% = a% + 1„ GET #1, a%, logon„ IF logins$ = logon.login THEN EXIT DO„ IF a% > 50 THEN EXIT DO„LOOP„GET #2, a%, file„IF a% = 51 THEN„ COLOR 4, 0„ center 13, "Incorrect Login Name!"„ SLEEP 3„ login„ELSE„ IF logon.password <> pass$ THEN„  COLOR 4, 0„  center 13, "Password Incorrect!"„  SLEEP 3„  login„ ELSE„„goahead:„  COLOR 2, 0„  goahead$ = "Login And Password Correct!"„  center 13, goahead$„  goahead$ = file.firstname + " " + file.midini + " " + file.lastname„  center 14, goahead$„  SLEEP 3„  mainmenu„ END IF„END IF„END SUB„„SUB logoff„drawscreen "Logging Off! Good Bye!"„GET #1, 51, logon„GET #2, 51, user„CLS„SCREEN 12„LINE (200, 1)-(440, 45), 7, BF„LINE (280, 46)-(360, 90), 4, BF„LINE (125, 91)-(515, 91), 7„LINE (125, 91)-(320, 479), 7„LINE (515, 91)-(320, 479), 7„CIRCLE (320, 200), 100, 7„CIRCLE (320, 200), 99, 4„CIRCLE (320, 200), 98, 4„CIRCLE (320, 200), 97, 4„CIRCLE (320, 200), 96, 4„CIRCLE (320, 200), 95, 4„PAINT (127, 92), 7, 7„LINE (340, 103)-(245, 265), 4„LINE (300, 103)-(395, 265), 4„LINE (320, 103)-(235, 250), 4„LINE (320, 103)-(405, 250), 4„LINE (300, 103)-(340, 103), 4„LINE (235, 250)-(245, 265), 4„LINE (405, 250)-(395, 265), 4„CIRCLE (320, 150), 100, 4, 4.047111, 5.372889„CIRCLE (320, 130), 100, 4, 4.047111, 5.372889„PAINT (320, 110), 4, 4„PAINT (310, 110), 4, 4„PAINT (330, 110), 4, 4„PAINT (310, 130), 4, 4„PAINT (330, 130), 4, 4„PAINT (320, 235), 4, 4„PAINT (260, 235), 4, 4„PAINT (380, 235), 4, 4„center 2, " Press Any Key "„DO WHILE kbd$ = ""„ kbd$ = ""„ kbd$ = INKEY$„ IF kbd$ = CHR$(27) THEN SYSTEM„ LOCATE 5, 27„ PRINT TIME$„ LOCATE 5, 47„ PRINT DATE$„LOOP„CLS„SCREEN 0„WIDTH 80, 25„login„END SUB„„SUB mainmenu„drawscreen "Main Menu"„SELECT CASE logon.level„CASE 1 'SysOp„ options$(1) = "Add User"„ options$(2) = "View User's Record"„ options$(3) = "Delete User"„ options$(4) = "Suspend User"„ options$(5) = "Set Time And Date"„ options$(6) = "Windows"„ options$(7) = "DOS"„ options$(8) = "E-Mail"„ options$(9) = "Logoff"„ o = Menu%„ IF o = 1 THEN adduser„ IF o = 2 THEN viewinfo„ IF o = 3 THEN killuser„ IF o = 4 THEN sususer„ IF o = 5 THEN settimedate„ IF o = 6 THEN windows„ IF o = 7 THEN dos„ IF o = 8 THEN email„ IF o = 9 THEN logoff„CASE 2 'Registered User„ options$(1) = "Calculator (Win)"„ options$(2) = "Calender (Win)"„ options$(3) = "Terminal (Win)"„ options$(4) = "Notepad (Win)"„ options$(5) = "Windows"„ options$(6) = "DOS"„ options$(7) = "E-Mail"„ options$(8) = "Change Password"„ options$(9) = "Logoff"„ o = Menu%„ IF o = 1 THEN wincalc„ IF o = 2 THEN wincal„ IF o = 3 THEN winterm„ IF o = 4 THEN winnote„ IF o = 5 THEN windows„ IF o = 6 THEN dos„ IF o = 7 THEN email„ IF o = 8 THEN newpass„ IF o = 9 THEN logoff„CASE 3 'Guest„ options$(1) = "Register"„ options$(2) = "Network Information"„ options$(3) = "Calculator (Win)"„ options$(4) = "Calender (Win)"„ options$(5) = "Terminal (Win)"„ options$(6) = "Notepad (Win)"„ options$(7) = "Windows"„ options$(8) = "DOS"„ options$(9) = "Logoff"„ o = Menu%„ IF o = 1 THEN adduser„ IF o = 2 THEN info„ IF o = 3 THEN wincalc„ IF o = 4 THEN wincal„ IF o = 5 THEN winterm„ IF o = 6 THEN winnote„ IF o = 7 THEN windows„ IF o = 8 THEN dos„ IF o = 9 THEN logoff„END SELECT„END SUB„„FUNCTION Menu%„COLOR 15, 0„FOR a% = 1 TO 9„ LOCATE a% + 3, 25„ PRINT a%; SPACE$(32)„ LOCATE a% + 3, 30„ PRINT options$(a%)„NEXT a%„cur% = 1„DO„ FOR a% = 1 TO 9„  LOCATE a% + 3, 24„  PRINT " "„ NEXT a%„ LOCATE cur% + 3, 24„ PRINT ">"„ DO„  kbd$ = ""„  kbd$ = INKEY$„  IF kbd$ = CHR$(13) THEN GOSUB chosen„  IF kbd$ = CHR$(0) + CHR$(&H48) THEN„   cur% = cur% - 1„   IF cur% = 0 THEN cur% = 9„   EXIT DO„  ELSEIF kbd$ = CHR$(0) + CHR$(&H50) THEN„   cur% = cur% + 1„   IF cur% = 10 THEN cur% = 1„   EXIT DO„  END IF„  IF VAL(kbd$) THEN„   cur% = VAL(kbd$)„   EXIT DO„  END IF„ LOOP„LOOP„   „chosen:„Menu% = cur%„END FUNCTION„„SUB newpass„drawscreen "Change Password"„LOCATE 4, 1„pass1$ = sinput$("Old Password: ")„IF logon.password = pass1$ THEN„ pass2$ = sinput$("New Password: ")„ logon.password = pass2$„ PUT #1, file.number, logon„ELSE„ BEEP„END IF„mainmenu„END SUB„„SUB percent (Row%, Col%, pct%)„LOCATE Row%, Col%„COLOR 15, 0„PRINT SPACE$(50)„LOCATE Row% + 1, Col% + 23„PRINT pct%„LOCATE Row%, Col%„IF pct% > 0 THEN„ FOR a% = 2 TO pct% STEP 2„  PRINT "€";„ NEXT a%„END IF„END SUB„„SUB readmail„drawscreen "Read Mail"„bluescreen„files$ = logon.login + ".eml"„OPEN files$ FOR RANDOM AS #4 LEN = LEN(emails)„IF LOF(4) / 914 > 0 THEN„ FOR a% = 1 TO LOF(4) / 914„  bluescreen„  LOCATE 4, 1„  GET #4, a%, emails„  PRINT "Message ID: "; emails.id„  PRINT "From: "; emails.from„  PRINT "Subject: "; emails.subject„  PRINT STRING$(80, "ƒ")„  mess$ = emails.message„  FOR b% = 1 TO 10„   c% = (b% * 80) - 79„   PRINT MID$(mess$, c%, 80)„  NEXT b%„  PRINT STRING$(80, "ƒ")„  center 19, "Press Any Key For Next Message"„  keywait„ NEXT a%„ELSE„ center 10, "No E-Mail Messages!"„END IF„center 19, "Press Any Key To Return To Menu"„CLOSE #4„keywait„email„END SUB„„SUB settimedate„drawscreen "Set Date And Time"„curtime$ = "Current Time: " + TIME$„curdate$ = "Current Date: " + DATE$„center 5, curtime$„center 6, curdate$„INPUT "Change Time (N or Time[hh:mm:ss]): ", chtime$„IF UCASE$(chtime$) <> "N" THEN„ TIME$ = chtime$„END IF„INPUT "Change Date (N or Time[mm-dd-yyyy]): ", chtime$„IF UCASE$(chtime$) <> "N" THEN„ DATE$ = chtime$„END IF„curtime$ = "Current Time: " + TIME$„curdate$ = "Current Date: " + DATE$„center 9, curtime$„center 10, curdate$„SLEEP 3„mainmenu„END SUB„„FUNCTION sinput$ (Text$)„PRINT Text$;„DO„ LOCATE CSRLIN, POS(1), 1„ a = a + 1„ kbd$ = ""„ DO WHILE kbd$ = ""„  kbd$ = ""„  kbd$ = INKEY$„ LOOP„ IF kbd$ = CHR$(13) THEN EXIT DO„ IF kbd$ = CHR$(8) THEN„  in$ = LEFT$(in$, a - 1)„  a = a - 1„  LOCATE CSRLIN, POS(1) - 1„  PRINT " "„  LOCATE CSRLIN, POS(2) - 1„ ELSE„  in$ = in$ + kbd$„  a = a + 1„  PRINT "*";„ END IF„LOOP„„sinput$ = in$„„END FUNCTION„„SUB sususer„drawscreen "Delete User"„LOCATE 5, 1: PRINT "Input Number or Login or Name:           "„LOCATE 5, 32: INPUT "", look$„b% = 0„DO„ b% = b% + 1„ LOCATE 6, 1„ PRINT "Searching Files For: "; look$; "! "„ IF b% < 11 THEN„  percent 7, 15, 0„  FOR a% = b% TO 10„   GET #2, a%, file„   IF file.firstname = look$ THEN b% = 51: EXIT FOR„   IF file.lastname = look$ THEN b% = 51: EXIT FOR„   IF file.number = VAL(look$) THEN b% = 51: EXIT FOR„   IF file.login = look$ THEN b% = 51: EXIT FOR„  NEXT a%„  b% = 11„ END IF„ IF b% > 10 AND b% < 21 THEN„  percent 7, 15, 20„  FOR a% = b% TO 20„   GET #2, a%, file„   IF file.firstname = look$ THEN b% = 51: EXIT FOR„   IF file.lastname = look$ THEN b% = 51: EXIT FOR„   IF file.number = VAL(look$) THEN b% = 51: EXIT FOR„   IF file.login = look$ THEN b% = 51: EXIT FOR„  NEXT a%„  b% = 21„ END IF„ IF b% > 20 AND b% < 31 THEN„  percent 7, 15, 40„  FOR a% = b% TO 30„   GET #2, a%, file„   IF file.firstname = look$ THEN b% = 51: EXIT FOR„   IF file.lastname = look$ THEN b% = 51: EXIT FOR„   IF file.number = VAL(look$) THEN b% = 51: EXIT FOR„   IF file.login = look$ THEN b% = 51: EXIT FOR„  NEXT a%„  b% = 31„ END IF„ IF b% > 30 AND b% < 41 THEN„  percent 7, 15, 60„  FOR a% = b% TO 40„   GET #2, a%, file„   IF file.firstname = look$ THEN b% = 51: EXIT FOR„   IF file.lastname = look$ THEN b% = 51: EXIT FOR„   IF file.number = VAL(look$) THEN b% = 51: EXIT FOR„   IF file.login = look$ THEN b% = 51: EXIT FOR„  NEXT a%„  b% = 41„ END IF„ IF b% > 40 AND b% < 51 THEN„  percent 7, 15, 80„  FOR a% = b% TO 20„   GET #2, a%, file„   IF file.firstname = look$ THEN b% = 51: EXIT FOR„   IF file.lastname = look$ THEN b% = 51: EXIT FOR„   IF file.number = VAL(look$) THEN b% = 51: EXIT FOR„   IF file.login = look$ THEN b% = 51: EXIT FOR„  NEXT a%„  b% = 52„ END IF„ percent 7, 15, 100„ IF b% = 52 THEN„  PRINT "No Match Found!"„  SLEEP 3„  GET #2, 2, file„  mainmenu„ END IF„ BEEP„ PRINT "Suspend"; file.number, file.login, file.firstname; " "; file.midini; ", "; file.lastname; " ";„ INPUT "? Y,N: ", del$„ IF UCASE$(del$) <> "N" THEN EXIT DO„LOOP„GET #1, file.number, user„user.access = 3„PUT #1, file.number, user„PRINT "Suspended!"„BEEP„SLEEP 3„GET #1, 2, user„GET #2, 2, file„mainmenu„END SUB„„SUB viewinfo„drawscreen "View User Information"„bluescreen„LOCATE 4, 1„PRINT "Number", "Login Name", "First Name M Last Name"„FOR a% = 1 TO 15„ GET #2, a%, file„ PRINT file.number, file.login, file.firstname; " "; file.midini; " "; file.lastname„NEXT a%„keywait„LOCATE 5, 1„FOR a% = 16 TO 30„ GET #2, a%, file„ PRINT file.number, file.login, file.firstname; " "; file.midini; " "; file.lastname„NEXT a%„keywait„LOCATE 5, 1„FOR a% = 31 TO 45„ GET #2, a%, file„ PRINT file.number, file.login, file.firstname; " "; file.midini; " "; file.lastname„NEXT a%„keywait„LOCATE 5, 1„FOR a% = 46 TO 60„ GET #2, a%, file„ PRINT file.number, file.login, file.firstname; " "; file.midini; " "; file.lastname„NEXT a%„keywait„GET #2, 2, file„mainmenu„END SUB„„SUB wincal„CLS„SHELL "Calender"„mainmenu„END SUB„„SUB wincalc„SHELL "calc"„mainmenu„END SUB„„SUB windows„drawscreen "Windows"„center 9, "Press ALT+TAB To Use Windows"„center 10, "When Done In Windows, Click On The QNET Button"„center 11, "To Return To The Main Menu, Press Enter"„WHILE INKEY$ <> CHR$(13): WEND„mainmenu„END SUB„„SUB winnote„CLS„SHELL "notepad"„mainmenu„„„„END SUB„„SUB winterm„CLS„SHELL "terminal"„mainmenu„END SUB„„SUB writemail„drawscreen "Write E-mail"„bluescreen„LOCATE 4, 1„id$ = RTRIM$(logon.login) + RIGHT$(DATE$, 4) + LEFT$(DATE$, 2) + MID$(DATE$, 4, 2) + LEFT$(TIME$, 2) + MID$(TIME$, 4, 2)„PRINT "Message ID: "; id$„INPUT "To: ", to$„INPUT "Subject: ", sub$„PRINT STRING$(80, "ƒ")„mess$ = linput$„LOCATE 18, 1„PRINT STRING$(80, "ƒ")„PRINT "Press Any Key To Send"„keywait„emails.id = id$„emails.subject = sub$„emails.going = to$„emails.from = logon.login„emails.message = mess$„files$ = emails.going + ".eml"„OPEN files$ FOR RANDOM AS #4 LEN = LEN(emails)„a% = (LOF(4) / 914) + 1„PUT #4, a%, emails„PRINT "Sent!"„SLEEP 3„CLOSE #4„email„END SUB„Scott Slater                   RETURN USER NAME ON NETWORK    captain@usaor.net              09-10-97 (20:05)       QB, PDS                127  4446     WHO_QB.BAS  ' ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ„' Program Title: WHO_QB.BAS„'     Copyright: Donated to PUBLIC DOMAIN By Scott Slater„'        Author: Scott Slater„' Last Modified: 09/10/1997„' ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ„'   Description: Similar to Novell's WHOAMI but written in QuickBASIC!„' ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ„'         Notes: Just tinkering may be useful later on.„' ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ„'       History: none, but look for a PowerBASIC version also.„' ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ„„' Change the INCLUDE to QBX.BI for PDS„„'$INCLUDE: 'QB.BI'„„DEFINT A-Z„„DECLARE FUNCTION GetConNum% ()„DECLARE FUNCTION GetConStat$ (ConNum%)„„Connection% = GetConNum%„„IF Connection% THEN„   PRINT "Logical Connection Number"; Connection%„ELSE„   PRINT "Not connected"„   END„END IF„„„'  The function  GetConStat$ will return either a nul string if there is no„'connection or login, or it will return a 62 byte string that can be broken„'down as follows:„'„'   Offset    Size    Description„'   00h       DWORD   unique user ID„'   04h       WORD    user type„'   06h   48  BYTEs   user name„'   36h    7  BYTEs   login time„'   3Dh       BYTE    reserved„'„„cs$ = GetConStat$(Connection%)„„IF cs$ = "" THEN                       ' see if we are connected if cs$ is„   PRINT "Not logged in"               ' NUL, we aren't logged in.„ELSE                                   ' otherwise we are„   li$ = MID$(cs$, 55, 7)              ' fill the login time buffer„   PRINT "UserName    : "; MID$(cs$, 7, 48) ' show the current username„   PRINT "Login time  : ";„   work = ASC(MID$(li$, 4, 1))         ' get the hour of login„   nm$ = LTRIM$(RTRIM$(STR$(work)))    ' convert it to a string„   IF work < 10 THEN nm$ = "0" + nm$   ' if single digit add a preceeding 0„   PRINT nm$; ":";                     ' print the hour„   work = ASC(MID$(li$, 5, 1))         ' get the minute of login„   nm$ = LTRIM$(RTRIM$(STR$(work)))    ' convert it to a string„   IF work < 10 THEN nm$ = "0" + nm$   ' if single digit add a preceeding 0„   PRINT nm$; ":";                     ' print minutes„   work = ASC(MID$(li$, 6, 1))         ' get the second of login„   nm$ = LTRIM$(RTRIM$(STR$(work)))    ' convert it to a string„   IF work < 10 THEN nm$ = "0" + nm$   ' if single digit add a preceeding 0„   PRINT nm$                           ' finaly, print the seconds„END IF„„PRINT                                  ' extra line„„END                                    ' see ya!„„FUNCTION GetConNum%„„   DIM inreg AS RegTypeX„   DIM outreg AS RegTypeX„„„   ' NetWare CONNECTION SERVICES - GET CONNECTION NUMBER Function DCh„„   inreg.ax = &HDC00                   ' Function DCh„   InterruptX &H21, inreg, outreg      ' call interrupt 21h„   Connection% = outreg.ax AND 255     ' AL holds connecton number„																				 '   or a 0 if no connection.„   GetConNum% = Connection%„„END FUNCTION„„FUNCTION GetConStat$ (ConNum%)„„   DIM ReqPack AS STRING * 7„   DIM RplPack AS STRING * 62„   DIM inreg AS RegTypeX„   DIM outreg AS RegTypeX„„   IF ConNum% > 0 THEN„„      ' Set up Request Buffer„„      Packet$ = CHR$(5) + CHR$(0)„      Packet$ = Packet$ + CHR$(28)„      Packet$ = Packet$ + CHR$(ConNum% AND 255) + CHR$((ConNum% AND &HFF00) / 256) + CHR$(0) + CHR$(0)„„      ReqPack = Packet$„„      FOR a = 1 TO 100                 ' Try this up to 100 times„	 inreg.ax = &HF217             ' Novell Get Connection Info Svc„	 inreg.cx = 7                  ' CX holds the len of the Request„				       '   Buffer„	 inreg.dx = 62                 ' DX holds the len of the Reply„				       '   Buffer„	 inreg.ds = VARSEG(ReqPack)    ' DS:SI = Address of Request Buffer„	 inreg.si = VARPTR(ReqPack)„	 inreg.es = VARSEG(RplPack)    ' ES:DI = Address of Reply Buffer„	 inreg.di = VARPTR(RplPack)„	 InterruptX &H21, inreg, outreg  ' call interrupt 21h„	 IF (outreg.ax AND 255) = 0 THEN EXIT FOR  ' AL returns 0 if successful„      NEXT„„      IF a > 100 THEN          ' see if we ran out of trys from above„	 GetConStat$ = ""„      ELSE„	 GetConStat$ = RplPack„      END IF„   ELSE„      GetConStat$ = ""„   END IF„„END FUNCTION„Scott Slater                   PB RETURN USER NAME ON NETWORK captain@usaor.net              09-10-97 (20:05)       PB                     195  7558     WHO.BAS     ' ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ„' Program Title: WHO.BAS„'     Copyright: Donated to PUBLIC DOMAIN By Scott Slater„'        Author: Scott Slater„' Last Modified: 09/10/1997„' ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ„'   Description: Similar to Novell's WHOAMI command but written in PB!„' ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ„'         Notes: MUST BE COMPILED WITH PowerBASIC v3.2 or Higher.„' ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ„'       History: none, but look for a QuickBASIC version also.„' ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ„„$cpu 8086                 ' program works on any CPU„„$optimize size            ' make smallest possible executable„$compile exe              ' compile to an EXE„„$debug map off            ' turn off map file generation„$debug pbdebug off        ' don't include pbdebug support in our executable„„$lib all        off       ' turn off PowerBASIC's internal libraries.„$error all      off       ' turn off all error checking„„$com    0                 ' set communications buffer to nothing„$string 16                ' set largest string size at 16k„$stack  2048              ' use a 2k stack„$sound  1                 ' smallest music buffer possible„„$dim all                  ' force all variables to be pre-dimensioned before„                          ' they can be used„$dynamic                  ' all arrays will be dynamic by default„„$option cntlbreak off     ' don't allow Ctrl-Break to exit program„„„declare function get_con_num() as dword„declare function get_con_stat(con_num as dword) as string„„„dim connect as dword                  ' dword to hold connection number„dim work as word                      ' work variable„dim li as string                      ' buffer for login time„dim nm as string                      ' string representation for each unit„dim cs as string                      ' string to hold connection status„„connect = get_con_num„„if connect then„   print "Logical Connection Number";connect„else„   print "Not connected"„   end„end if„„$IF 0„„  The function  get_con_stat will return either a nul string if there is no„connection or login, or it will return a 62 byte string that can be broken„down as follows:„„   Offset    Size    Description„   00h       DWORD   unique user ID„   04h       WORD    user type„   06h   48  BYTEs   user name„   36h    7  BYTEs   login time„   3Dh       BYTE    reserved„„$ENDIF„„cs = get_con_stat(connect)„„if cs = "" then                       ' see if we have a connection, cs will„   print "Not logged in"              ' be NUL if we don't„else                                  ' otherwise we are connected„   li = mid$(cs,55,7)                 ' fill the login time buffer„   print "UserName    : "; mid$(cs,7,48)   ' show the current username„   print "Login time  : ";„   work = ascii(mid$(li,4,1))         ' get the hour of login„   nm = ltrim$(rtrim$(str$(work)))    ' convert it to a string„   if work < 10 then nm = "0" + nm    ' if single digit add a preceeding 0„   print nm;":";                      ' print the hour„   work = ascii(mid$(li,5,1))         ' get the minute of login„   nm = ltrim$(rtrim$(str$(work)))    ' convert it to a string„   if work < 10 then nm = "0" + nm    ' if single digit add a preceeding 0„   print nm;":";                      ' print minutes„   work = ascii(mid$(li,6,1))         ' get the second of login„   nm = ltrim$(rtrim$(str$(work)))    ' convert it to a string„   if work < 10 then nm = "0" + nm    ' if single digit add a preceeding 0„   print nm                           ' finaly, print the seconds„end if„„print                                 ' extra line„„end                                   ' see ya!„„„„function get_con_num () public as dword„„' NetWare CONNECTION SERVICES - GET CONNECTION NUMBER Function DCh„„   dim connection_number as local byte„„   !   mov ah, &HDC                        ; function DCh„   !   int &H21                            ; call interrupt 21h„   !   mov connection_number, al           ; al holds the connection number„                                           '   or a 0 if no connection.„   function = connection_number„„end function„„function get_con_stat(con_num as dword) public as string„   dim len_of_data as word„   dim subfunct as byte„„   dim reqt as string * 7„   dim repl as string * 62„„   dim d1 as dword ptr„   dim d2 as dword ptr„   dim w1 as word ptr„   dim w2 as word ptr„   dim b1 as byte ptr„   dim b2 as byte ptr                 ' 2's are pointers to string„„   dim seg1 as word, seg2 as word, off1 as word, off2 as word, trys as word„„„   ' Set up Request Buffer„„   len_of_data = 5                    ' length of following data„   subfunct = &H1C                    ' subfunction "Get Connection Info"„„   w1 = varptr32(len_of_data)         ' pointer to len_of_data„   b1 = varptr32(subfunct)            ' pointer to subfunct„   d1 = varptr32(con_num)             ' pointer to con_num„   b2 = varptr32(reqt)                ' byte pointer to byte 1 of reqt„„   w2 = b2                            ' initialize all string pointers to„   d2 = b2                            ' point to the first byte of reqt„   incr b2, 2                         ' Position of byte in string„   incr d2, 3                         ' Position of dword in string„„   ' move the data„„   @w2 = @w1                          ' move the word data to the string„   @b2 = @b1                          ' move the byte data to the string„   @d2 = @d1                          ' move the dword data to the string„„„   ' call asm routine to get the information from NetWare Connection Services„„   ' NetWare GET CONNECTION INFORMATION Function F2h„„   if con_num then„„      seg1 = varseg(reqt)             ' segment address of reqt„      off1 = varptr(reqt)             ' offset of reqt„      seg2 = varseg(repl)             ' segment address of repl„      off2 = varptr(repl)             ' offset of repl„„   rtry:„„      !   push ds                     ; save ds for powerbasic„      !   mov ax, &HF217              ; function F217h„      !   mov cx, 7                   ; length of request packet (reqt)„      !   mov dx, 62                  ; length of reply packet (repl)„      !   mov ds, seg1                ; point ds:si to address of request„      !   mov si, off1                ;    packet„      !   mov es, seg2                ; point es:di to address of reply„      !   mov di, off2                ;    packet„      !   int &H21                    ; call interrupt 21h„      !   pop ds                      ; restore the ds„      !   mov subfunct, al            ; copy the contents of al into subfunct„      !   cmp al, 0                   ; if it returns 0, success„      !   je done                     ; so jump to label "done"„      !   inc trys                    ; otherwise increment our counter by 1„      !   cmp trys, 100               ; have we made 100 trys?„      !   je done                     ; if so jump to label "done"„      !   jmp rtry                    ; otherwise jump to label "rtry"„„   done:„„      if trys = 100 then„         function = ""„      else„         function = repl„      end if„„   else„      function = ""„   end if„„end function„Scott Slater                   NOVELL NETWARE FUNCTIONS FOR PBcaptain@usaor.net              09-13-97 (23:51)       PB                     545  19319    NWCALLS.BAS ' ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ„' Program Title: NWCALLS.BAS„'     Copyright: Donated to PUBLIC DOMAIN By Scott Slater„'        Author: Scott Slater„' Last Modified: 09/14/1997„' ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ„'   Description: Some Novell NetWare functions for PowerBASIC„' ƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒƒ„„%EXEFILE = 1              ' change to 0 to compile as a unit„„$cpu 8086                 ' program works on any CPU„„$optimize size            ' make smallest possible executable„„$if %EXEFILE              ' if we're making an EXE„„$compile exe              ' compile to an EXE„„$else                     ' otherwise„„$compile unit             ' compile to a unit„„$endif„„$debug map off            ' turn off map file generation„$debug pbdebug off        ' don't include pbdebug support in our executable„„$lib all        off       ' turn off PowerBASIC's internal libraries.„$error all      off       ' turn off all error checking„„$com    0                 ' set communications buffer to nothing„$string 16                ' set largest string size at 16k„$stack  2048              ' use a 2k stack„$sound  1                 ' smallest music buffer possible„„$dim all                  ' force all variables to be pre-dimensioned before„                          ' they can be used„$dynamic                  ' all arrays will be dynamic by default„„$option cntlbreak off     ' don't allow Ctrl-Break to exit program„„„type FullNetAddress                   ' full net address buffer type„   NetWork   as string * 4„   Node      as string * 6„   Socket    as string * 2„end type„„type ReqPack1                         ' request packet type 1 for function„  length     as word                  ' E3h calls„  funct      as byte„end type„„type RplPack1                         ' reply packet type 1 for function„  length     as word                  ' E3h calls„  SrvName    as string * 48„  Major      as byte„  Minor      as byte„  totconn    as word„  usedconn   as word„  maxvols    as word„  enumm      as word„  reserved   as string * 88„end type„„type ReqPack2                         ' request packet type 2 for function„  length     as word                  ' E3h calls„  funct      as byte„  connect    as byte„end type„„type RplPack2                         ' reply packet type 2 for function„  length     as word                  ' E3h calls„  beID       as dword„  UserType   as word„  UserName   as string * 48„  LoginTime  as string * 8„end type„„declare function NWGetConn() as word„declare function strim(wordvar as word) as string„declare function strimb(bytevar as byte) as string„declare function Str2Hex(StrVar as string) as string„„$if %EXEFILE„„' TEST CODE HERE!„„  declare function IPXInstalled() as byte„  declare function NWGetVer() as single„  declare function NWGetServerName() as string„  declare function NWGetFullAddress() as string„  declare function NWGetUserName() as string„  declare function NWGetLoginTime(style as byte) as string„  declare function NWGetNodeAddress() as string„  declare function NWGetNetworkNumber() as string„„„  dim us as string„„  if IPXInstalled then„    if NWGetVer then„      Print„      Print NWGetServerName;" is running NetWare";NWGetVer„      Print "This station's connection number is";NWGetConn„      Print "and its full IPX address is ";NWGetFullAddress„      Print„      us = NWGetUserName„      if us = "Not Logged In" then„        Print "Currently ";us„      else„        Print "User ";us;" logged in on ";NWGetLoginTime(3)„        Print "from node ";NWGetNodeAddress;" on Network ";NWGetNetworkNumber„      end if„    else„      Print "IPX is installed, but no server information is available."„    end if„  else„    Print "No IPX Installed on this station."„  end if„  Print„  end„„$endif„„'--------------------------------------------------------------------------„' NetWare CONNECTION SERVICES - GET CONNECTION NUMBER Function DCh„'--------------------------------------------------------------------------„„function NWGetConn() public as word„   !   push ds                             ; save ds for PowerBASIC„   !   mov ah, &HDC                        ; function DCh„   !   int &H21                            ; call interrupt 21h„   !   pop ds                              ; restore the ds„   !   mov function, al                    ; al holds the connection number„end function„„„„'--------------------------------------------------------------------------„' NetWare SERVER INFO SERVICES - GET CURRENT VERSION   Function E3h„'--------------------------------------------------------------------------„„function NWGetVer() public as single„   dim request as reqpack1„   dim reply as rplpack1„   dim seg1 as word„   dim seg2 as word„   dim off1 as word„   dim off2 as word„„   request.length = len(request)           ' length of request buffer„   request.funct = &H11                    ' sub function 11h„   reply.length = len(reply)               ' length of the reply buffer„„   seg1 = varseg(request)             ' segment address of request buffer„   off1 = varptr(request)             ' offset of request buffer„   seg2 = varseg(reply)               ' segment address of reply buffer„   off2 = varptr(reply)               ' offset of reply buffer„„   !   push ds                        ; save the ds for PowerBASIC„   !   mov ax, &HE300                 ; function E3h„   !   mov ds, seg1                   ; address of request buffer goes„   !   mov si, off1                   ;   into ds:si„   !   mov es, seg2                   ; address of reply buffer goes„   !   mov di, off2                   ;   into es:di„   !   int &H21                       ; interrupt 21h„   !   pop ds                         ; restore the ds„„   !   cmp al, 0                      ; is al = 0 ?„   !   jne ver_err                    ; if not we have an error„   !   jmp ver_ok                     ; if so we are successful„„ver_err:„„   function = 0„   exit function„„ver_ok:„„   function = reply.major + (reply.minor/100)  ' return version info„„end function„„„„'--------------------------------------------------------------------------„' NetWare SERVER INFO SERVICES - GET SERVER NAME   Function E3h SubFunc 11h„'--------------------------------------------------------------------------„„function NWGetServerName() public as string„   dim request as reqpack1„   dim reply as rplpack1„   dim seg1 as word„   dim seg2 as word„   dim off1 as word„   dim off2 as word„   dim temp as string„„   request.length = len(request)      ' length of request buffer„   request.funct = &H11               ' sub function 11h„   reply.length = len(reply)          ' length of reply buffer„„   seg1 = varseg(request)             ' segment address of request buffer„   off1 = varptr(request)             ' offset of request buffer„   seg2 = varseg(reply)               ' segment address of reply buffer„   off2 = varptr(reply)               ' offset of reply buffer„„   !   push ds                        ; save the ds for PowerBASIC„   !   mov ax, &HE300                 ; function E3h„   !   mov ds, seg1                   ; address of request buffer goes„   !   mov si, off1                   ;   into ds:si„   !   mov es, seg2                   ; address of reply buffer goes„   !   mov di, off2                   ;   into es:di„   !   int &H21                       ; interrupt 21h„   !   pop ds                         ; restore the ds„„   !   cmp al, 0                      ; is al = 0?„   !   jne srv_err                    ; if not we have an error„   !   jmp srv_ok                     ; if so, we are done„„srv_err:„„   function = "Not Attached"          ' we weren't successful so we must„   exit function                      ' not be attached to a server„„srv_ok:„„   temp = reply.SrvName„   function = left$(temp, instr(temp, chr$(0)) - 1)  'return the server name„„end function„„'--------------------------------------------------------------------------„' NETWARE SHELL SERVICES - GET NODE ADDRESS    Function EEh„'--------------------------------------------------------------------------„„function NWGetNodeAddress() public as string„   dim part1 as word„   dim part2 as word„   dim part3 as word„   dim temp as string„„   !   push ds                        ; save the ds for PowerBASIC„   !   xor ax, ax                     ; 0 the ax register„   !   mov ah, &HEE                   ; function EEh„   !   int &H21                       ; interrupt 21h„   !   mov part3, ax                  ; copy contents of ax to part3„   !   mov part2, bx                  ; copy contents of bx to part2„   !   mov part1, cx                  ; copy contents of cx to part1„   !   pop ds                         ; restore the ds„„   temp = right$("0000" + hex$(part1),4)          ' build the node address„   temp = temp +right$("0000" + hex$(part2),4)    ' from all 3 parts„   temp = temp +right$("0000" + hex$(part3),4)„„   function = temp                    ' return the node address„„end function„„„'--------------------------------------------------------------------------„' IPX SERVICES - GET NETWORK NUMBER       Function 9h, of Int 7Ah„'--------------------------------------------------------------------------„„function NWGetNetworkNumber() public as string„   dim NetAdd as FullNetAddress„   dim seg1 as word„   dim off1 as word„   dim temp as string„„   seg1 = varseg(NetAdd)„   off1 = varptr(NetAdd)„„   !   push ds                        ; save the ds for PowerBASIC„   !   xor bx, bx                     ; 0 the bx register„   !   mov bx, &H9                    ; put 9h into bx„   !   mov es, seg1                   ; address of NetAdd (Buffer) goes„   !   mov si, off1                   ;   into es:si„   !   int &H7A                       ; interrupt 7Ah„   !   pop ds                         ; restore the ds„„   temp = NetAdd.Network„„   function = Str2Hex(temp)           ' return network address„„end function„„'--------------------------------------------------------------------------„' IPX SERVICES - GET FULL ADDRESS         Function 9h, of Int 7Ah„'--------------------------------------------------------------------------„„function NWGetFullAddress() public as string„   dim NetAdd as FullNetAddress„   dim seg1 as word„   dim off1 as word„   dim temp1 as string„   dim temp2 as string„„   seg1 = varseg(NetAdd)„   off1 = varptr(NetAdd)„„   !   push ds                        ; save the ds for PowerBASIC„   !   xor bx, bx                     ; 0 the bx„   !   mov bx, &H9                    ; copy 9h to bx„   !   mov es, seg1                   ; address of NetAdd (Buffer) goes„   !   mov si, off1                   ;   into es:si„   !   int &H7A                       ; interrupt 7Ah„   !   pop ds                         ; restore the ds„„   temp1 = NetAdd.NetWork             ' build the entire network address„   temp2 = Str2Hex(temp1)             ' as follows;„   temp1 = NetAdd.Node                ' XXXXXXXX:NNNNNNNNNNNN:SSSS„   temp2 = temp2 + ":" + Str2Hex(temp1)   ' where X is the Network Number„   temp1 = NetAdd.Socket                  ' N is the node address„   temp2 = temp2 + ":" + Str2Hex(temp1)   ' S is the Socket Number„„   function = temp2                   ' return the full address„„end function„„'--------------------------------------------------------------------------„' IPX SERVICES - IPX DETECTION    Function 7Ah„'--------------------------------------------------------------------------„'„'  Returns FFh (255) if IPX is installed, 0 if not.„'„„function IPXInstalled() public as byte„   !  push ds                         ; save the ds for PowerBASIC„   !  xor ax, ax                      ; 0 the ax register„   !  mov ah, &H7A                    ; function 7Ah„   !  int &H2F                        ; interrupt 2Fh„   !  pop ds                          ; restore ds„   !  mov function, al                ; result is in al FFh=TRUE  0h=FALSE„end function„„„'--------------------------------------------------------------------------„' NetWare CONNECTION SERVICES - GET USER NAME    Function E3h SubFunc 16h„'--------------------------------------------------------------------------„„function NWGetUserName() public as string„   dim request as reqpack2„   dim reply as rplpack2„   dim seg1 as word„   dim seg2 as word„   dim off1 as word„   dim off2 as word„   dim temp as string„„   request.length = len(request)      ' length of request buffer„   request.funct = &H16               ' subfunction 16h„   request.connect = (NWGetConn AND &HFF)   ' connection number„   reply.length = len(reply)          ' length of reply buffer„„   seg1 = varseg(request)             ' segment address of request buffer„   off1 = varptr(request)             ' offset of request buffer„   seg2 = varseg(reply)               ' segment address of reply buffer„   off2 = varptr(reply)               ' offset of reply buffer„„   !   push ds                        ; save ds for PowerBASIC„   !   xor ax, ax                     ; 0 the ax register„   !   mov ah, &HE3                   ; function E3h„   !   mov ds, seg1                   ; address of Request buffer goes„   !   mov si, off1                   ;   into ds:si„   !   mov es, seg2                   ; address of reply buffer goes„   !   mov di, off2                   ;   into es:di„   !   int &H21                       ; interrupt 21h„   !   pop ds                         ; restore the ds„„   !   cmp al, 0                      ; is the al set to 0?„   !   jne usr_err                    ; if not we have an error„   !   jmp usr_ok                     ; if so, we were successful„„usr_err:„„   function = "Not Logged In"„   exit function„„usr_ok:„„   temp = reply.UserName„   function = left$(temp, instr(temp, chr$(0)) - 1)  'return user name„„end function„„'--------------------------------------------------------------------------„' NetWare CONNECTION SERVICES - GET LOGIN TIME   Function E3h SubFunc 16h„'--------------------------------------------------------------------------„'„'  Syntax:   PRINT NWGetLoginTime(x) „'„'  where x = 0, 1, 2, or 3 to produce different output styles„„function NWGetLoginTime(style as byte) public as string„   dim request as reqpack2„   dim reply as rplpack2„   dim seg1 as word„   dim seg2 as word„   dim off1 as word„   dim off2 as word„   dim temp1 as string„   dim temp2 as string„   dim year as word„   dim month as byte„   dim day as byte„   dim day_of_week as byte„   dim hour as byte„   dim minute as byte„   dim sec as byte„„   request.length = len(request)      ' length of request buffer„   request.funct = &H16               ' sub function 16h„   request.connect = (NWGetConn AND &HFF)   ' connection number„   reply.length = len(reply)          ' length of reply buffer„„   seg1 = varseg(request)             ' segment address of request buffer„   off1 = varptr(request)             ' offset of request buffer„   seg2 = varseg(reply)               ' segment address of reply buffer„   off2 = varptr(reply)               ' offset of reply buffer„„   !   push ds                        ; save the ds for PowerBASIC„   !   xor ax, ax                     ; 0 the ax register„   !   mov ah, &HE3                   ; function E3h„   !   mov ds, seg1                   ; address of request buffer goes„   !   mov si, off1                   ;   into ds:si„   !   mov es, seg2                   ; address of reply buffer goes„   !   mov di, off2                   ;   into es:di„   !   int &H21                       ; interrupt 21h„   !   pop ds                         ; restore the ds„„   !   cmp al, 0                      ; is al = 0 ?„   !   jne lit_err                    ; if not we have an error„   !   jmp lit_ok                     ; if so, we were successful„„lit_err:„„   function = ""„   exit function„„lit_ok:                               ' construct the return string„„   year = 1900 + cvbyt(mid$(reply.LogInTime,1,1))„   month = cvbyt(mid$(reply.LogInTime,2,1))„   day = cvbyt(mid$(reply.LogInTime,3,1))„   hour = cvbyt(mid$(reply.LogInTime,4,1))„   minute = cvbyt(mid$(reply.LogInTime,5,1))„   sec = cvbyt(mid$(reply.LogInTime,6,1))„   day_of_week = cvbyt(mid$(reply.LogInTime,7,1))„„   if (style and 2) then                   ' 12 hour time„     if hour > 12 then„       hour = hour - 12„       temp1 = strimb(hour) + ":" + strimb(minute)„       temp1 = temp1 + ":" + strimb(sec) + " PM"„     else„       temp1 = strimb(hour) + ":" + strimb(minute)„       temp1 = temp1 + ":" + strimb(sec) + " AM"„     end if„   else                                  ' 24 hour time„     temp1 = strimb(hour) + ":" + strimb(minute)„     temp1 = temp1 + ":" + strimb(sec)„   end if„„   if (style and 1) then                   ' long date format„      select case month„        case 1„          temp2 = "January "„        case 2„          temp2 = "February "„        case 3„          temp2 = "March "„        case 4„          temp2 = "April "„        case 5„          temp2 = "May "„        case 6„          temp2 = "June "„        case 7„          temp2 = "July "„        case 8„          temp2 = "August "„        case 9„          temp2 = "September "„        case 10„          temp2 = "October "„        case 11„          temp2 = "November "„        case 12„          temp2 = "December "„      end select„      temp2 = temp2 + strimb(day) + ", " + strim(year)„      select case day_of_week„        case 0„          temp2 = "Sunday " + temp2„        case 1„          temp2 = "Monday " + temp2„        case 2„          temp2 = "Tuesday " + temp2„        case 3„          temp2 = "Wednesday " + temp2„        case 4„          temp2 = "Thursday " + temp2„        case 5„          temp2 = "Friday " + temp2„        case 6„          temp2 = "Saturday " + temp2„      end select„   else                                  ' Short Date Format„      temp2 = strimb(month) + "/" + strimb(day) + "/" + strim(year)„   end if„   „   function = temp2 + " at " + temp1„„end function„„'  used internaly to convert word to a string and remove spaces„function strim(w as word) as string„  function = ltrim$(rtrim$(str$(w)))„end function„„'  used internaly to convert byte to a string, remove spaces, and make„'  propper length„function strimB(b as byte) as string„  function = right$("00" + ltrim$(rtrim$(str$(b))),2)„end function„„'  used internaly to convert IPX Call String values to hex„function Str2Hex (strval as string) as string„   dim temp as string„   dim count as integer„   dim sng as single„   temp = ""„   for count = 1 to len(strval)„      sng = asc(mid$(strval, count, 1))„      if sng < 15 then„         temp = temp + "0" + hex$(sng)„      else„         temp = temp + hex$(sng)„      end if„   next count„   function = temp„end function„